<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Stedfast as thou art."/><link rel="alternate" href="/atom.xml" title="Calios' Eden"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="http://www.caliosd.gq/page/4/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-71292392-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-71292392-1');
</script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>Calios' Eden</title>
  <link rel="alternate" href="/atom.xml" title="Calios' Eden" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Calios' Eden</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Calios' Eden</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/09/03/differences-among-workspace-project-target-scheme/">【译】Workspace & Project & Target & Scheme 的区别</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-09-03
        </span></div>
    </header>

    <div class="post-content"><p>来自<a href="http://stackoverflow.com/users/916299/james-webster" title="http://stackoverflow.com/users/916299/james-webster" target="_blank" rel="external">James Webster</a>的回答：</p>
<ul>
<li><strong>Workspace:</strong> 包含一个或多个<code>project</code>，这些<code>project</code>通常是相互关联的。</li>
<li><strong>Project:</strong> 包括代码和资源等等。（你会熟悉这些的。）</li>
<li><strong>Target:</strong> 每个<code>project</code>都有一个或多个<code>target</code>。<ul>
<li>每个target都定义了该<code>project</code>的 build setting列表。</li>
<li>每个target还定义了在build时需要引用或使用的类、资源、自定义脚本的列表。</li>
<li>Target通常用于同一个project的不同发布版本。<ul>
<li>比如，我的项目有两个target，一个通用构建和一个官方构建，其中后者包含额外测试功能，可能还包含几种背景音乐轨道，还有一个切换轨道的按钮。</li>
<li>你应该已经习惯于向默认的target中添加类和资源了。</li>
<li>你可以挑选哪些类／资源被添加到哪个target中。<ul>
<li>在我的例子中，我有一个叫“DebugHandler”的类要添加到官方构建中。</li>
</ul>
</li>
<li>如果你添加测试，就需要添加一个新的target了。</li>
</ul>
</li>
</ul>
</li>
<li><strong>Scheme: </strong> Scheme定义了当你按下“Build”，“Test”，“Profile”的时候会发生什么。<ul>
<li>通常情况下，每个target包括至少一个scheme。</li>
<li>你可以为你的target自动创建scheme，方法是在 Scheme > Manage Schemes，点“Autocreate Schemes Now”。</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Ref:</strong></p>
<ul>
<li><a href="http://stackoverflow.com/a/20637892/1594792" target="_blank" rel="external">http://stackoverflow.com/a/20637892/1594792</a></li>
<li><a href="http://www.teratotech.com/blog/xcode-7-steps-to-easily-switch-between-multiple-environments/" target="_blank" rel="external">http://www.teratotech.com/blog/xcode-7-steps-to-easily-switch-between-multiple-environments/</a></li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/08/19/summary-for-hr-project/">某HR项目iOS端总结</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-08-19
        </span></div>
    </header>

    <div class="post-content"><h3 id="1-产品设计"><a href="#1-产品设计" class="headerlink" title="1.产品设计"></a>1.产品设计</h3><ul>
<li>及时更新RP图。</li>
<li>对于iOS和Android差异化不大的页面，可以使用一套RP图。</li>
<li>保证对页面逻辑的详细说明。</li>
<li>对于特殊状态（如筛选、搜索等）的说明／图解要清晰。</li>
</ul>
<h3 id="2-接口文档部分"><a href="#2-接口文档部分" class="headerlink" title="2.接口文档部分"></a>2.接口文档部分</h3><h5 id="2-1-文档编写的注意事项："><a href="#2-1-文档编写的注意事项：" class="headerlink" title="2.1 文档编写的注意事项："></a>2.1 文档编写的注意事项：</h5><ul>
<li>对于所有接口都通用的参数或JSON数据格式，可以添加公共设置的部分，集中说明。 </li>
<li>请求数据的参数，要说明哪些是必须的，哪些是可选的，可选的默认值是什么。 </li>
<li>说清请求数据的方式是GET还是POST。 </li>
<li>命名要清晰，对于<strong>名词</strong>命名的参数，区分清楚<code>xxId</code>和<code>xxTitle</code>，而不是<code>xx</code>。 </li>
<li>标记类型、状态类型的文字，与其移动端和服务器各自手动维护一组枚举值，不如传输<strong>文字本身</strong>。 </li>
<li>请求参数和返回参数中，特殊类型的数据要说明。如日期的格式是<code>yyyy-MM-dd</code>、<code>yyyy/MM/dd</code>还是<code>yyyy.MM</code>。 </li>
<li>无需将userId/username传给服务器时，坚决不传，避免服务器端对于userId/username的误用。</li>
<li>可以将“凡是以<code>xxId</code>命名的字段一定为表的主键”这样的规则写在文档开始的公共说明中。</li>
<li>明确可选参数对应值为空时，是传“key:”” ”还是直接不传参数的key。</li>
<li>文档中要有详实的例子，还要注意按照接口调用的时序组织文档。</li>
</ul>
<h5 id="2-2-工作流程："><a href="#2-2-工作流程：" class="headerlink" title="2.2 工作流程："></a>2.2 工作流程：</h5><ul>
<li>现在的流程：<br>  pc端数据库设计与开发 》移动端产品设计 》<strong>移动端开发 》移动端接口设计</strong> 》pc端接口开发 </li>
</ul>
<ul>
<li><p>可优化为：<br>  pc端数据库设计与开发 》移动端产品设计 》<strong>移动端接口设计 》移动端开发</strong> 》pc端接口开发 </p>
</li>
<li><p>优化后的好处：</p>
<ul>
<li>避免移动端Model构建时，逐个比对字段名称的问题。</li>
<li>减少pc端依照“移动端写的接口文档”各种修改字段名的问题。</li>
<li>面向接口进行代码设计，可以在项目初期就对各功能模块有整体认识。</li>
</ul>
</li>
</ul>
<h5 id="2-3-编写工具："><a href="#2-3-编写工具：" class="headerlink" title="2.3 编写工具："></a>2.3 编写工具：</h5><ul>
<li><p>现在的工具：<br>  word + SVN(?)</p>
</li>
<li><p>存在的问题：</p>
<ul>
<li>各种和文档相关的样式、乱码、排版的问题。</li>
<li>无法即时调试，需自行粘贴到postman去测试。</li>
</ul>
</li>
<li><p>可优化为：<br>  － swagger：<a href="http://editor.swagger.io/#/" target="_blank" rel="external">http://editor.swagger.io/#/</a><br>  － RAP（from Alibaba）： </p>
<ul>
<li>Github：<a href="https://github.com/thx/RAP" target="_blank" rel="external">https://github.com/thx/RAP </a><ul>
<li>说明：<a href="http://div.io/topic/642" target="_blank" rel="external">http://div.io/topic/642</a> </li>
<li>例子：<a href="http://rap.taobao.org/workspace/myWorkspace.do?projectId=5359#37446" target="_blank" rel="external">http://rap.taobao.org/workspace/myWorkspace.do?projectId=5359#37446</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="2-4-接口设计要考虑的问题（供参考）："><a href="#2-4-接口设计要考虑的问题（供参考）：" class="headerlink" title="2.4 接口设计要考虑的问题（供参考）："></a>2.4 接口设计要考虑的问题（供参考）：</h5><ul>
<li><a href="http://ismartstudio.com/mobile-app-server-side-api-should-be-designed-to-take-into-account-problems.html" target="_blank" rel="external">http://ismartstudio.com/mobile-app-server-side-api-should-be-designed-to-take-into-account-problems.html </a></li>
<li><a href="https://segmentfault.com/q/1010000002523945" title="https://segmentfault.com/q/1010000002523945" target="_blank" rel="external">https://segmentfault.com/q/1010000002523945</a> </li>
</ul>
<h3 id="3-移动端开发"><a href="#3-移动端开发" class="headerlink" title="3.移动端开发"></a>3.移动端开发</h3><h5 id="3-1-BugList分析"><a href="#3-1-BugList分析" class="headerlink" title="3.1 BugList分析"></a>3.1 BugList分析</h5><p>BugList（iOS端）汇总图表及明细<br>（见<code>XX HR iOS端BugList汇总及明细.xlsx</code>）</p>
<p>Bug数量最多的类型前三类（单位：个）：</p>
<ul>
<li>逻辑缺失（23）</li>
<li>和pc端对接问题（19）</li>
<li>未与RP图对照（14）</li>
</ul>
<p>逐个分析一下：</p>
<h5 id="3-1-1-逻辑缺失"><a href="#3-1-1-逻辑缺失" class="headerlink" title="3.1.1 逻辑缺失"></a>3.1.1 逻辑缺失</h5><p>共计23个逻辑缺失的Bug中，比较突出的问题有：</p>
<ul>
<li>数据更新后没有自动刷新的问题（6个）  </li>
<li>页面或数据状态的保存或传递问题（5个）；</li>
<li>网络请求时，可选参数key为空的处理（2个）。</li>
</ul>
<p><strong>解决建议</strong></p>
<ul>
<li>对于数据有可能更新的列表，要添加自动刷新功能；</li>
<li>请求数据时，可以不传的参数key需要单独处理。</li>
</ul>
<h5 id="3-1-2-和pc端对接问题"><a href="#3-1-2-和pc端对接问题" class="headerlink" title="3.1.2 和pc端对接问题"></a>3.1.2 和pc端对接问题</h5><p>和pc端对接的相关Bug中，问题主要集中在：</p>
<ul>
<li>移动端使用字段错误，导致展示错误信息（6个）；</li>
<li>不同接口的<code>BaseURL</code>不相同（后期已统一）（3个）；</li>
<li>移动端使用的校验方式与pc端不一致（3个）；</li>
<li>空值的传输和处理（3个）：当某字段的值为空时，需传给服务器key和空值。</li>
</ul>
<p><strong>解决建议</strong></p>
<ul>
<li>增强对接口文档的统一理解；</li>
<li>pc端和移动端可以在各自的接口开发时约定好：<ul>
<li>所有接口的<code>BaseURL</code>；</li>
<li>除了<code>status=1</code>和<code>status=-1</code>的状态外，其他可能存在<code>status=0</code>的接口。</li>
</ul>
</li>
</ul>
<h5 id="3-1-3-未与RP图对照"><a href="#3-1-3-未与RP图对照" class="headerlink" title="3.1.3 未与RP图对照"></a>3.1.3 未与RP图对照</h5><p>主要由于在RP图不断更新的过程中，未能及时变更相应流程、操作和用户友好性的细节。这一部分的bug，是应该在自测中消除掉的。</p>
<h5 id="3-2-代码分析"><a href="#3-2-代码分析" class="headerlink" title="3.2 代码分析"></a>3.2 代码分析</h5><h5 id="3-2-1-代码行数统计"><a href="#3-2-1-代码行数统计" class="headerlink" title="3.2.1 代码行数统计"></a>3.2.1 代码行数统计</h5><table>
<thead>
<tr>
<th>文件夹</th>
<th>代码行数</th>
</tr>
</thead>
<tbody>
<tr>
<td>Classes</td>
<td>21357</td>
</tr>
<tr>
<td>Utility</td>
<td>2941</td>
</tr>
<tr>
<td>Constant</td>
<td>1498</td>
</tr>
<tr>
<td>AppDelegate</td>
<td>201</td>
</tr>
<tr>
<td>Categories</td>
<td>1758</td>
</tr>
<tr>
<td><strong>Sum</strong></td>
<td><strong>27755</strong></td>
</tr>
</tbody>
</table>
<h5 id="3-2-2-公共类的封装"><a href="#3-2-2-公共类的封装" class="headerlink" title="3.2.2 公共类的封装"></a>3.2.2 公共类的封装</h5><ul>
<li><code>BaseFundamentalViewController</code>中封装了空数据的处理、网络请求等通用功能，项目中几乎所有controller都继承自该类。</li>
<li><code>BaseViewController</code>继承自<code>BaseFundamentalViewController</code>。主要封装了与TableView相关的功能，如上拉加载、添加／清除筛选条件等。没有特殊需求的普通列表的展示，只需要不到50行代码。</li>
<li><code>BaseWebViewController</code>继承自<code>BaseFundamentalViewController</code>。主要用于全屏的webview模板展示。</li>
</ul>
<h5 id="3-2-3-代码复用"><a href="#3-2-3-代码复用" class="headerlink" title="3.2.3 代码复用"></a>3.2.3 代码复用</h5><ul>
<li>以后可能用到的功能模块：<ul>
<li><code>Base</code>系列；</li>
<li>下载管理（<em>待完善</em>）；</li>
<li>WebView模板展示（GRMustache）；</li>
<li>表格展示（GridView）；</li>
<li>Charts展示（Charts）；</li>
<li>图片浏览及选择（支持多选，MWPhotoBrowser）；</li>
<li>表单的展示及填写（XLForm）；</li>
<li>年月选择器。</li>
</ul>
</li>
</ul>
<h3 id="4-美工-amp-测试"><a href="#4-美工-amp-测试" class="headerlink" title="4.美工 &amp; 测试"></a>4.美工 &amp; 测试</h3><ul>
<li>对于移动端的切图可以逐渐模板化，如某些固定尺寸、固定的需求（如：Android的图片设计时有效内容尽量居中，便于自行剪裁）等。</li>
<li>时间允许的条件下，同类型bug可以设置关联bug，方便开发人员统一修复。</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/07/24/commands-in-svn/">实用svn命令</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-07-24
        </span></div>
    </header>

    <div class="post-content"><p>1.Check all the changed files:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> svn st</span></div></pre></td></tr></table></figure></p>
<p>2.Check the differences between this version and the last version:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> svn diff -r PREV filename</span></div></pre></td></tr></table></figure></p>
<p>3.Undo add a file before commit:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- language: bash --&gt;</span></div><div class="line">	$ svn revert --recursive folder_name</div></pre></td></tr></table></figure></p>
<p>4.Undo delete a file before commit:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> svn revert . --recursive</span></div></pre></td></tr></table></figure></p>
<p>5.Delete all locally missing files: <a href="http://stackoverflow.com/questions/9600382/svn-command-to-delete-all-locally-missing-files" title="http://stackoverflow.com/questions/9600382/svn-command-to-delete-all-locally-missing-files" target="_blank" rel="external">solutions</a></p>
<p>6.Delete a folder from svn repository:<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ svn <span class="keyword">delete</span> http:<span class="regexp">//</span>www.yourrepository.com<span class="regexp">/svn/</span>folder --message <span class="string">"Deleting"</span></div></pre></td></tr></table></figure></p>
<p>7.Revert to a previous SVN revision of a file:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> svn merge -c -854 l3toks.dtx</span></div></pre></td></tr></table></figure></p>
<p>8.Ignore Pods foler:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> svn propset svn:ignore Pods .</span></div></pre></td></tr></table></figure></p>
<p>9.SVN remains in conflict status:<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ svn resolved &lt;filename <span class="keyword">or</span> directory <span class="keyword">that</span> gives trouble&gt;</div></pre></td></tr></table></figure></p>
<p>10.View all historical changes to a file in SVN:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"></div><div class="line"><span class="comment"># history_of_file</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Outputs the full history of a given file as a sequence of</span></div><div class="line"><span class="comment"># logentry/diff pairs.  The first revision of the file is emitted as</span></div><div class="line"><span class="comment"># full text since there's not previous version to compare it to.</span></div><div class="line"></div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">history_of_file</span></span>() &#123;</div><div class="line">    url=<span class="variable">$1</span> <span class="comment"># current url of file</span></div><div class="line">    svn <span class="built_in">log</span> -q <span class="variable">$url</span> | grep -E -e <span class="string">"^r[[:digit:]]+"</span> -o | cut -c2- | sort -n | &#123;</div><div class="line"></div><div class="line"><span class="comment">#       first revision as full text</span></div><div class="line">        <span class="built_in">echo</span></div><div class="line">        <span class="built_in">read</span> r</div><div class="line">        svn <span class="built_in">log</span> -r<span class="variable">$r</span> <span class="variable">$url</span>@HEAD</div><div class="line">        svn cat -r<span class="variable">$r</span> <span class="variable">$url</span>@HEAD</div><div class="line">        <span class="built_in">echo</span></div><div class="line"></div><div class="line"><span class="comment">#       remaining revisions as differences to previous revision</span></div><div class="line">        <span class="keyword">while</span> <span class="built_in">read</span> r</div><div class="line">        <span class="keyword">do</span></div><div class="line">            <span class="built_in">echo</span></div><div class="line">            svn <span class="built_in">log</span> -r<span class="variable">$r</span> <span class="variable">$url</span>@HEAD</div><div class="line">            svn diff -c<span class="variable">$r</span> <span class="variable">$url</span>@HEAD</div><div class="line">            <span class="built_in">echo</span></div><div class="line">        <span class="keyword">done</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$ history_of_file <span class="variable">$1</span></div></pre></td></tr></table></figure></p>
<p>11.Add tags for SVN:</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># First of all, the `ios/1.0.39219` directory should already exists. If it doesn't, you can create it using `svn mkdir` like below.</span></div><div class="line"><span class="variable">$ </span>svn mkdir <span class="symbol">http:</span>/<span class="regexp">/path/to</span><span class="regexp">/project/tags</span><span class="regexp">/projectA/mobile</span><span class="regexp">/ios/</span><span class="number">1.0</span>.<span class="number">39219</span> -m <span class="string">"create tag v1.0 for iOS."</span></div><div class="line"><span class="variable">$ </span>svn copy <span class="symbol">http:</span>/<span class="regexp">/path/to</span><span class="regexp">/project/trunk</span><span class="regexp">/projectA/mobile</span><span class="regexp">/ios/project</span>A <span class="symbol">http:</span>/<span class="regexp">/path/to</span><span class="regexp">/project/tags</span><span class="regexp">/projectA/mobile</span><span class="regexp">/ios/</span><span class="number">1.0</span>.<span class="number">39219</span>/projectA -m <span class="string">"create v1.0. Before updating all the base url and cas url."</span></div><div class="line"></div><div class="line">Committed revision <span class="number">41000</span>.</div></pre></td></tr></table></figure>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/07/07/set-deployment-target-for-CocoaPods'-pod-in-batches/">Set deployment target for CocoaPods’ pod in batches</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-07-07
        </span></div>
    </header>

    <div class="post-content"><p>When I tried to <code>pod update</code> an old project, it changed all the pods’ deployment target to 8.0. I’ve been tired up with changing it all the time and finally found <a href="http://stackoverflow.com/a/37289688/1594792" title="http://stackoverflow.com/a/37289688/1594792" target="_blank" rel="external">this solution</a>.</p>
<p>It says:</p>
<blockquote>
<p>While some development versions of CocoaPods (as well as pre-1.0 versions) may have propagated the deployment target of the project down to the pods, this is no longer the case in 1.0. To work around this, the current developer recommends using a post-install hook.<br>Here’s a brute force approach to force a hard-coded deployment target for every pod in the generated Pods project. Paste this at the end of your Podfile:<br><figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">post_install <span class="built_in">do</span> |<span class="type">installer</span>|</div><div class="line">  <span class="type">installer</span>.pods_project.targets.each <span class="built_in">do</span> |<span class="type">target</span>|</div><div class="line">    <span class="type">target</span>.build_configurations.each <span class="built_in">do</span> |<span class="type">config</span>|</div><div class="line">      <span class="type">config</span>.build_settings['IPHONEOS_DEPLOYMENT_TARGET'] = '<span class="number">9.2</span>'</div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>Replace <code>9.2</code> with whatever deployment target you would like to use.</p>
</blockquote>
<p>It does work in two of my projects and the warnings and errors are silent again. LOL.</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/05/27/notes-for-Charts/">Some notes for Charts</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-27
        </span></div>
    </header>

    <div class="post-content"><h3 id="Minimum-deployment-target-of-Charts-is-iOS-8-0"><a href="#Minimum-deployment-target-of-Charts-is-iOS-8-0" class="headerlink" title="Minimum deployment target of Charts is iOS 8.0."></a>Minimum deployment target of Charts is iOS <strong>8.0</strong>.</h3><h3 id="Cocoapods-1-0-0-tips"><a href="#Cocoapods-1-0-0-tips" class="headerlink" title="Cocoapods-1.0.0 tips."></a>Cocoapods-1.0.0 tips.</h3><ul>
<li>Add <code>use_frameworks!</code> for iOS 8+;</li>
<li>Specify a target for each pod.</li>
</ul>
<p>eg. if before you had your Podfile written like this:</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">pod</span> <span class="string">'Alamofire'</span>, <span class="string">'~&gt; 3.1.4'</span></div><div class="line">pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.3.2'</span></div></pre></td></tr></table></figure>
<p>just change it to</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">target <span class="string">"TargetName"</span> <span class="built_in">do</span></div><div class="line">    pod <span class="string">'Alamofire'</span>, <span class="string">'~&gt; 3.1.4'</span></div><div class="line">    pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.3.2'</span></div><div class="line"><span class="built_in">end</span></div></pre></td></tr></table></figure>
<h3 id="Bridging-between-Objective-C-and-Swift"><a href="#Bridging-between-Objective-C-and-Swift" class="headerlink" title="Bridging between Objective-C and Swift."></a>Bridging between Objective-C and Swift.</h3><ul>
<li>In fact, after installing <code>Charts</code> with Cocoapods and building <code>.xcworkspace</code>, it automatically generates <code>Charts-Swift.h</code> file, which you can use directly in you <code>.m</code> file with <code>#import &lt;Charts/Charts-Swift.h&gt;</code>.(Here my project is OC-based.)</li>
<li>Check some build settings and parameters:<ul>
<li>Product Module Name: yourProject</li>
<li>Defines Module: YES</li>
<li>Embedded Content Contains Swift: YES</li>
<li>Install Objective-C Compatibility Header: YES</li>
<li>Objective-C Bridging Header: $(SRCROOT)/Sources/SwiftBridging.h</li>
</ul>
</li>
</ul>
<p>Here’s <a href="http://stackoverflow.com/a/24005242/1594792" target="_blank" rel="external">step by step integration for Xcode between Objc and Swift in project</a>.</p>
<p>However, I failed to use OC framework in Swift-based project with Cocoapods and still couldn’t tell why. I’ll add it later if I make it.</p>
<p><strong>Update on 2017-04-12</strong></p>
<p>I finally import Objective-C framework into Swift-based project, just after change <code>Targets/Build Settings/Swift Compiler-General/Install Objective-C Compatibility Header</code> in Xcode from <code>No</code> to <code>Yes</code>. :]</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/05/25/[SourceCodeRead]-CAPSPageMenu/">[SourceCodeRead]-CAPSPageMenu</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-25
        </span></div>
    </header>

    <div class="post-content"><h3 id="［1］-所有配置选项均为extern-const-string"><a href="#［1］-所有配置选项均为extern-const-string" class="headerlink" title="［1］ 所有配置选项均为extern const string"></a>［1］ 所有配置选项均为extern const string</h3><p>具体来说，即：每个选项对应一个属性，在初始化方法中，通过获取到的选项字典依次给对象的各个属性赋值。</p>
<p>如：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// CAPSPageMenu.h</span></div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">CAPSPageMenuOptionSelectionIndicatorHeight</span>;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">CAPSPageMenuOptionMenuItemSeparatorWidth</span>;</div><div class="line"></div><div class="line"><span class="comment">// CAPSPageMenu.m</span></div><div class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">CAPSPageMenuOptionSelectionIndicatorHeight</span>             = <span class="string">@"selectionIndicatorHeight"</span>;</div><div class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">CAPSPageMenuOptionMenuItemSeparatorWidth</span>               = <span class="string">@"menuItemSeparatorWidth"</span>;</div></pre></td></tr></table></figure></p>
<p>在初始化方法中，根据遍历传入的options参数，依次给各个属性赋值。<br><figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (instance<span class="keyword">type</span>)initWithViewControllers:(<span class="type">NSArray</span> *)viewControllers frame:(<span class="type">CGRect</span>)frame options:(<span class="type">NSDictionary</span> *)options&#123;</div><div class="line">		for (<span class="type">NSString</span> *key in options) &#123;</div><div class="line">            if ([key isEqualToString:<span class="type">CAPSPageMenuOptionSelectionIndicatorHeight</span>]) &#123;</div><div class="line">                _selectionIndicatorHeight = [options[key] floatValue];</div><div class="line">            &#125; else if ([key isEqualToString: <span class="type">CAPSPageMenuOptionMenuItemSeparatorWidth</span>]) &#123;</div><div class="line">                _menuItemSeparatorWidth = [options[key] floatValue];</div><div class="line">            &#125;</div><div class="line">	...</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在使用时，传入组装好的自定义option。<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">  <span class="string">NSDictionary</span> <span class="meta">*parameters</span> <span class="string">=</span> <span class="string">@&#123;</span></div><div class="line"><span class="attr">CAPSPageMenuOptionScrollMenuBackgroundColor:</span> <span class="string">[UIColor</span> <span class="attr">colorWithRed:30.0/255.0</span> <span class="attr">green:30.0/255.0</span> <span class="attr">blue:30.0/255.0</span> <span class="attr">alpha:1.0],</span></div><div class="line"><span class="attr">CAPSPageMenuOptionViewBackgroundColor:</span> <span class="string">[UIColor</span> <span class="attr">colorWithRed:20.0/255.0</span> <span class="attr">green:20.0/255.0</span> <span class="attr">blue:20.0/255.0</span> <span class="attr">alpha:1.0],</span></div><div class="line"><span class="attr">CAPSPageMenuOptionSelectionIndicatorColor:</span> <span class="string">[UIColor</span> <span class="string">orangeColor]&#125;;</span></div><div class="line"></div><div class="line">  <span class="string">_pageMenu</span> <span class="string">=</span> <span class="string">[[CAPSPageMenu</span> <span class="string">alloc]</span> <span class="attr">initWithViewControllers:controllerArray</span> <span class="attr">frame:CGRectMake(0.0,</span> <span class="number">0.0</span><span class="string">,</span> <span class="string">self.view.frame.size.width,</span> <span class="string">self.view.frame.size.height)</span> <span class="attr">options:parameters];</span></div><div class="line">  <span class="string">[self.view</span> <span class="attr">addSubview:_pageMenu.view];</span></div></pre></td></tr></table></figure></p>
<p>在很多系统的类库中都使用这种方式来传递自定义的选项值。比如<code>NSAttributedString</code>的初始化方法<code>-initWithString:attributes:</code>中的<code>attributes</code>是自己组装的dictionary，而其中的key就是UIKit下<code>NSAttributedString.h</code>中的“Predefined character attributes for text.”</p>
<p>以后在写自己的类库中可以参考这种方式。</p>
<h3 id="［2］-关于UIScrollView的scrollsToTop属性"><a href="#［2］-关于UIScrollView的scrollsToTop属性" class="headerlink" title="［2］ 关于UIScrollView的scrollsToTop属性"></a>［2］ 关于<code>UIScrollView</code>的<code>scrollsToTop</code>属性</h3><p>当用户点击status bar时，点击位置下面最靠近status bar的scroll view会滚到顶部，但只有以下条件都满足时才会生效：</p>
<ul>
<li><code>scrollsToTop</code>属性值为<code>YES</code>；</li>
<li>代理方法<code>shouldScrollViewScrollToTop</code>没有返回<code>NO</code>；</li>
<li>没有已经处于顶部。</li>
</ul>
<p>这里需要注意的是，如果有<strong>不止一个</strong>scroll view的<code>scrollsToTop</code>被置为<code>YES</code>，那么<strong>所有</strong>scroll view的“点击滚动到顶部”<strong>都不会生效</strong>。</p>
<p>然而，UIScrollView的<code>scrollsToTop</code>默认是<code>YES</code>…所以，对于<code>CAPSPageMenu</code>中的两个scroll view，作者都手动将它们的<code>scrollsToTop</code>置为了<code>NO</code>。<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_menuScrollView.<span class="keyword">scrollsToTop </span>      = NO<span class="comment">;;</span></div><div class="line">_controllerScrollView.<span class="keyword">scrollsToTop </span>= NO<span class="comment">;;</span></div></pre></td></tr></table></figure></p>
<p>另外，对于<code>UIScrollView</code>的子类们，如<code>UITableView</code>、<code>UICollectionView</code>、<code>UITextView</code>、<code>UIContainerView</code>等，该规则同样适用。</p>
<h3 id="［3］-为什么在点击item时需要一个Timer？"><a href="#［3］-为什么在点击item时需要一个Timer？" class="headerlink" title="［3］ 为什么在点击item时需要一个Timer？"></a>［3］ 为什么在点击item时需要一个Timer？</h3><p>未知。。。</p>
<h3 id="［4］-gestureRecognizer-shouldRecognizeSimultaneouslyWithGestureRecognizer"><a href="#［4］-gestureRecognizer-shouldRecognizeSimultaneouslyWithGestureRecognizer" class="headerlink" title="［4］-gestureRecognizer: shouldRecognizeSimultaneouslyWithGestureRecognizer:"></a>［4］<code>-gestureRecognizer: shouldRecognizeSimultaneouslyWithGestureRecognizer:</code></h3><p>虽然view和gesture recognizer可以是一对多的关系，但默认情况下，两个gesture recognizer是不能同时有效的。此时，若想两个gesture recognizer能同时处理它们各自的gesture，需要重写<code>UIScrollView</code>的protocol<code>-gestureRecognizer: shouldRecognizeSimultaneouslyWithGestureRecognizer:</code>，并在其中返回<code>YES</code>。</p>
<p>在一个gesture recognizer对于gesture的识别会阻塞另一个gesture recognizer的gesture识别时，这个方法就会被调用了。</p>
<p>当然，也可以根据需要在其中添加判断条件，使之返回不同的值。<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer</div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> ([gestureRecognizer isKindOfClass:[<span class="built_in">UIPanGestureRecognizer</span> <span class="keyword">class</span>]]  &amp;&amp; [otherGestureRecognizer isKindOfClass:[<span class="built_in">UIScreenEdgePanGestureRecognizer</span> <span class="keyword">class</span>]]) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">      &#125;    </div><div class="line">	<span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><strong>Ref:</strong></p>
<ul>
<li><a href="http://stackoverflow.com/a/8960080/1594792" target="_blank" rel="external">http://stackoverflow.com/a/8960080/1594792</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizer_basics/GestureRecognizer_basics.html#//apple_ref/doc/uid/TP40009541-CH2-SW2" target="_blank" rel="external">https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizer_basics/GestureRecognizer_basics.html#//apple_ref/doc/uid/TP40009541-CH2-SW2</a></li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/05/24/essay-mobile-meeting-160523/">0523-移动端会议有感</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-24
        </span></div>
    </header>

    <div class="post-content"><h3 id="1-技术，最后的终点都是应用。所以，要充分考虑use-case"><a href="#1-技术，最后的终点都是应用。所以，要充分考虑use-case" class="headerlink" title="1. 技术，最后的终点都是应用。所以，要充分考虑use case"></a>1. 技术，最后的终点都是应用。所以，要充分考虑use case</h3><p><strong>例如：</strong>考虑iOS端如何实现图文混排的展示问题，在选择使用模板来规范获取到的html时，如果出现文字环绕图片的状况，是否也能完美展示？</p>
<p><strong>延伸思考：</strong>获取到的html来自哪里－》来自用户－》用户的行为不可控－》输入的图文样式不可控－》所以，调研时选定方案时，需要充分测试各种图文混排的效果。</p>
<p><strong>结论：</strong>不止是测试需要测试案例，设计需要Persona，开发的技术调研、选择技术方案时也需要充分考虑use case。</p>
<h3 id="2-思考一个问题，要尽量全方位地考虑"><a href="#2-思考一个问题，要尽量全方位地考虑" class="headerlink" title="2. 思考一个问题，要尽量全方位地考虑"></a>2. 思考一个问题，要尽量全方位地考虑</h3><p><img src="http://mmbiz.qpic.cn/mmbiz/bwj0DnTUVQuIQvnX7vuvibCtVicEGt9jGXV03CW3RRSjAwAzs6jUmEKoIgNBoInCqn6pibl7TwB5x19SejSfEAvUQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="" title="思考能力的六大分类"></p>
<p>恰好今天早上看到了奴隶社会发的这篇<a href="http://mp.weixin.qq.com/s?__biz=MzA3NDMyOTcxMQ==&amp;mid=2651240054&amp;idx=1&amp;sn=927642e6f2a884458a2356b7e8dacf04&amp;scene=1&amp;srcid=0524kbGqhd8mXTrnlAU68vnh&amp;from=groupmessage&amp;isappinstalled=0#wechat_redirect" target="_blank" rel="external">《独立思考能力怎么培养？》</a>。一方面，对于自己子女今后的教育多了一分思考；另一方面，想到昨天的会议中也有部分与之相通。通常情况下，我们还都处于上图六个层次的底三层，仅限于应用。或者说，只知道<em>用什么（what）</em>和<em>怎么做（how）</em>，但是对于<em>为什么（why）</em>却知之甚少。</p>
<ul>
<li>为什么这种方案可以，为什么那种方案不可以？</li>
<li>如果选择这种方案，现有的实现方式是什么？</li>
<li>需要多少人月的投入？</li>
<li>我们能否在已有实现方式的基础上实现微创新？</li>
</ul>
<p>我相信思维这种东西，没有那么多天生的快与慢。快者，如福尔摩斯，也无非是以他自己的方式建造了一座记忆宫殿，而他知晓通往宫殿每个角落的最短路径。慢者，如我等，还需要刻意训练自己的思维能力，让大脑中的灰质细胞不断增加，让神经元更容易地将灰质细胞连接起来，让我们可以更加“融会贯通”。</p>
<h3 id="3-要经常总结，落到文字和图片上"><a href="#3-要经常总结，落到文字和图片上" class="headerlink" title="3.要经常总结，落到文字和图片上"></a>3.要经常总结，落到文字和图片上</h3><p>这个不用多说了。这也是我写这个博客的初衷之一吧。:)</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/05/17/notes-for-TextKit/">Some notes for TextKit</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-17
        </span></div>
    </header>

    <div class="post-content"><h3 id="Use-semantic-approach-for-font-in-latter-projects"><a href="#Use-semantic-approach-for-font-in-latter-projects" class="headerlink" title="Use semantic approach for font in latter projects"></a>Use semantic approach for font in latter projects</h3><blockquote>
<ul>
<li>Using a semantic approach to font names, such as UIFontTextStyleSubHeadline, helps avoid hard-coded font names and styles throughout your code — and ensures that your app will respond properly to user-defined typography settings as expected.</li>
<li>Font descriptors help you avoid the use of hardcoded font strings to set font types and styles.</li>
<li>Font descriptors are a type of descriptor language that allows you to modify fonts by applying specific attributes, or to obtain details of font metrics, without the need to instantiate an instance ofUIFont.</li>
</ul>
</blockquote>
<h3 id="exclusionPaths-property"><a href="#exclusionPaths-property" class="headerlink" title="exclusionPaths property"></a><code>exclusionPaths</code> property</h3><figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">NS_CLASS_AVAILABLE(10_0, 7_0) @interface NSTextContainer<span class="keyword"> :</span> NSObject &lt;NSCoding, NSTextLayoutOrientationProvider&gt;</div><div class="line"></div><div class="line">// Default value<span class="keyword"> :</span> empty<span class="built_in"> array </span> An<span class="built_in"> array </span>of UIBezierPath representing the exclusion paths inside the receiver's bounding rect.</div><div class="line">@property(copy, NS_NONATOMIC_IOSONLY) NSArray&lt;UIBezierPath *&gt; *exclusionPaths NS_AVAILABLE(10_11, 7_0);</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<blockquote>
<p> You might have noticed that the exclusionPaths property expects an instance of NSArray; therefore each container can support more than one exclusion path.</p>
</blockquote>
<h3 id="Class-clusters"><a href="#Class-clusters" class="headerlink" title="Class clusters"></a>Class clusters</h3><blockquote>
<p>Class clusters are a commonly used design pattern throughout Apple’s frameworks.<br>A class cluster is simply the Objective-C implementation of the Abstract Factory pattern, which provides a common interface for creating families of related or dependent objects without specifying the concrete classes. Familiar classes such as NSArray and NSNumber are in fact the public interface to a cluster of classes.</p>
</blockquote>
<h3 id="Set-hight-of-UITextView-CGFLOAT-MAX"><a href="#Set-hight-of-UITextView-CGFLOAT-MAX" class="headerlink" title="Set hight of UITextView CGFLOAT_MAX"></a>Set hight of UITextView <code>CGFLOAT_MAX</code></h3><p>In any case, this is more than enough to allow the UITextView to scroll and accommodate long passages of text.</p>
<h3 id="NSRange"><a href="#NSRange" class="headerlink" title="NSRange"></a><code>NSRange</code></h3><p>来自Mattt的一篇：<a href="http://nshipster.com/nsrange/" target="_blank" rel="external">http://nshipster.com/nsrange/</a></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/05/17/rich-text-solutions-in-iOS/">iOS上富文本的解决方案</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-17
        </span></div>
    </header>

    <div class="post-content"><h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>富文本无非要实现两类效果：</p>
<ul>
<li>图片和文字的混排</li>
<li>文字样式的随意修改</li>
</ul>
<h3 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h3><ul>
<li>通过CoreText/TextKit来原生实现</li>
<li>通过webView来间接实现</li>
</ul>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h3><p>一图胜千言：<br><img src="http://7xkwcv.com1.z0.glb.clouddn.com/iOS%E4%B8%8A%E5%AF%8C%E6%96%87%E6%9C%AC%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.png" alt=""></p>
<h4 id="通过CoreText-TextKit来原生实现"><a href="#通过CoreText-TextKit来原生实现" class="headerlink" title="通过CoreText/TextKit来原生实现"></a>通过CoreText/TextKit来原生实现</h4><p> iOS 6之前：CoreText,纯C语言,极其蛋疼<br> iOS 6开始：NSAttributedString,简单易用<br> iOS 7开始：TextKit,功能强大,简单易用</p>
<p><strong>对于NSAttributedString（iOS6开始）：</strong></p>
<ul>
<li>可以给指定范围（range）内的string添加属性（见UIKit中的<code>NSAttributedString.h</code>中的属性列表）；</li>
<li>可以使用它的类方法<code>attributedStringWithAttachment:</code>，将图片以附件（<code>NSTextAttachment</code>）的形式附加在已有NSAttributedString的后面。</li>
</ul>
<p><strong>对于TextKit（iOS7开始）：</strong></p>
<ul>
<li>可以通过继承<code>NSTextStorage</code>或<code>NSLayoutManager</code>来对不同的样式（如指定文字的高亮、背景颜色、下划线等）进行自定义处理；</li>
<li>可以设置<code>NSTextContainer</code>的<code>exclusionPaths</code>属性来设置镂空区域。</li>
</ul>
<p><strong>对于DTCoreText：</strong></p>
<ul>
<li>对CoreText进行了封装；</li>
<li>可以将html转换成<code>NSAttributedString</code>，而依然以<strong>html的样式</strong>展示出来；</li>
<li>支持CSS样式的展示；</li>
<li>支持内嵌html5视频及播放；</li>
<li>支持对多种附件（图片、视频等）的自定义处理；</li>
<li>支持远程图片等懒加载。</li>
</ul>
<p><strong>补充：</strong></p>
<p>正如<a href="http://stackoverflow.com/questions/4217820/convert-html-to-nsattributedstring-in-ios/18886718#18886718" target="_blank" rel="external">pix</a>所说，iOS7起，UIKit中添加了<code>initWithData:options:documentAttributes:error:</code>方法，可以用HTML来初始化一个NSAttributedString对象。如下：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[[<span class="built_in">NSAttributedString</span> alloc] initWithData:[htmlString dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>]</div><div class="line">                                 options:@&#123;<span class="built_in">NSDocumentTypeDocumentAttribute</span>: <span class="built_in">NSHTMLTextDocumentType</span>,</div><div class="line">                                           <span class="built_in">NSCharacterEncodingDocumentAttribute</span>: @(<span class="built_in">NSUTF8StringEncoding</span>)&#125;</div><div class="line">                      documentAttributes:<span class="literal">nil</span> error:<span class="literal">nil</span>];</div></pre></td></tr></table></figure></p>
<p>但从评论中来看，普遍反映执行起来花费时间很长。所以类似情况，还是优先考虑使用DTCoreText。</p>
<hr>
<p><strong>Ref:</strong></p>
<ul>
<li>CoreText教程：<a href="https://www.raywenderlich.com/4147/core-text-tutorial-for-ios-making-a-magazine-app" target="_blank" rel="external">https://www.raywenderlich.com/4147/core-text-tutorial-for-ios-making-a-magazine-app</a></li>
<li>DTCoreText: <a href="https://github.com/Cocoanetics/DTCoreText" target="_blank" rel="external">https://github.com/Cocoanetics/DTCoreText</a></li>
<li>DTCoreText-Demo: <a href="https://github.com/yoon-boom/DTCoreText-DEMO" target="_blank" rel="external">https://github.com/yoon-boom/DTCoreText-DEMO</a>(Happy to find an executable one!)</li>
<li>DTCoreText的源码分析：<a href="http://blog.cnbang.net/tech/2630/" target="_blank" rel="external">http://blog.cnbang.net/tech/2630/</a></li>
<li>TextKit教程：<a href="https://www.raywenderlich.com/50151/text-kit-tutorial" target="_blank" rel="external">https://www.raywenderlich.com/50151/text-kit-tutorial</a></li>
<li>YYText：<a href="https://github.com/ibireme/YYText" target="_blank" rel="external">https://github.com/ibireme/YYText</a></li>
<li><a href="http://stackoverflow.com/questions/4217820/convert-html-to-nsattributedstring-in-ios/18886718#18886718" target="_blank" rel="external">http://stackoverflow.com/questions/4217820/convert-html-to-nsattributedstring-in-ios/18886718#18886718</a></li>
</ul>
<h4 id="通过webView来间接实现"><a href="#通过webView来间接实现" class="headerlink" title="通过webView来间接实现"></a>通过webView来间接实现</h4><p>原理是类似symfony中的twig模板，将设计好的模板存在项目中（.mustache和.html），字体保存为.ttf，然后每次请求数据时，将服务器返回的html用这个模板进行渲染，再用嵌入的webview加载，从而得到整体风格一致的页面。</p>
<p>具体实现可以参考开源中国iOS版本的源码。</p>
<hr>
<p><strong>Ref:</strong></p>
<ul>
<li>GRMustache：<a href="https://github.com/groue/GRMustache" target="_blank" rel="external">https://github.com/groue/GRMustache</a></li>
<li><a href="https://github.com/syntaxhighlighter/syntaxhighlighter" target="_blank" rel="external">https://github.com/syntaxhighlighter/syntaxhighlighter</a></li>
<li>开源中国iOS版本源码：<a href="http://git.oschina.net/oschina/iphone-app/tree/master" target="_blank" rel="external">http://git.oschina.net/oschina/iphone-app/tree/master</a></li>
</ul>

        </div></article>
      <nav class="pagination"><a class="prev" href="/page/3/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    <a class="next" href="/page/5/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:calios_1124@163.com" class="iconfont icon-email" title="email"></a>
        <a href="http://github.com/caliosd" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Calios</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
