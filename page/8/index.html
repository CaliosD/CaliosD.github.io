<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Stedfast as thou art."/><link rel="alternate" href="/atom.xml" title="Calios' Eden"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="http://www.caliosd.gq/page/8/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-71292392-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-71292392-1');
</script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>Calios' Eden</title>
  <link rel="alternate" href="/atom.xml" title="Calios' Eden" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Calios' Eden</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Calios' Eden</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/01/28/[SourceCodeRead]-SDWebImage-1/">[SourceCodeRead] SDWebImage-1</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-01-28
        </span></div>
    </header>

    <div class="post-content"><p><a href="https://github.com/rs/SDWebImage" title="https://github.com/rs/SDWebImage" target="_blank" rel="external">SDWebImage</a>ä½œä¸ºä¸€ä¸ªå°†æœåŠ¡å™¨è¿œç¨‹çš„å›¾ç‰‡è·å–åˆ°UIImageViewä¸Šæ˜¾ç¤ºçš„ä¸€ä¸ªç¬¬ä¸‰æ–¹ç±»åº“ï¼Œäºæˆ‘è€Œè¨€ï¼Œæœ€ä¸ºå¸¸ç”¨çš„APIè«è¿‡äº<code>-sd_setImageWithURL: placeholderImage:</code>æ–¹æ³•ã€‚ä¸å¦¨ä»¥æ­¤å…¥æ‰‹ï¼Œæ‹¨å¼€å®ƒæºä»£ç çš„ç¥ç§˜é¢çº±ã€‚</p>
<hr>
<p><img src="http://7xkwcv.com1.z0.glb.clouddn.com/QQ20160506-0.png" alt="" title="UIImage+WebCache.mç‰‡æ®µ"></p>
<p>ç‚¹å…¥.mæ–‡ä»¶ï¼Œå‘ç°ä¸Šå›¾ä¸­ä»ä¸Šè‡³ä¸‹çš„ä¸€åˆ—æ–¹æ³•ï¼Œéƒ½ä¾æ¬¡æŒ‡å‘ç›¸é‚»çš„ä¸‹ä¸€ä¸ªæ–¹æ³•ï¼Œä¸è¿‡åœ¨ä¸Šå±‚è°ƒç”¨æ—¶ä¸ªåˆ«å‚æ•°ç½®ä¸º<code>nil</code>æˆ–<code>0</code>ã€‚ç›´åˆ°<code>-sd_setImageWithURL: placeholderImage:options:progress:completed:</code>è¿™ä¸ª<strong>æ ¸å¿ƒæ–¹æ³•</strong>ï¼Œæ–¹è§ç«¯å€ªã€‚<br><figure class="highlight erlang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- <span class="params">(void)</span>sd_setImageWithURL:<span class="params">(NSURL *)</span>url placeholderImage:<span class="params">(UIImage *)</span>placeholder options:<span class="params">(SDWebImageOptions)</span>options progress:<span class="params">(SDWebImageDownloaderProgressBlock)</span>progressBlock completed:<span class="params">(SDWebImageCompletionBlock)</span>completedBlock &#123;</div><div class="line">    [self sd_cancelCurrentImageLoad];</div><div class="line">    objc_setAssociatedObject<span class="params">(self, &amp;imageURLKey, url, OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span>; // [1]</div><div class="line"></div><div class="line">    if <span class="params">(!(options &amp; SDWebImageDelayPlaceholder)</span>) &#123; // [2]</div><div class="line">        dispatch_main_async_safe<span class="params">(^&#123;</span></div><div class="line">            self.image = placeholder;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ï¼»1ï¼½objc-setAssociatedObject"><a href="#ï¼»1ï¼½objc-setAssociatedObject" class="headerlink" title="ï¼»1ï¼½objc_setAssociatedObject"></a>ï¼»1ï¼½objc_setAssociatedObject</h3><h4 id="1-è¿™è´§æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-è¿™è´§æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. è¿™è´§æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. è¿™è´§æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>æ ¹æ®è‹¹æœçš„<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/ObjCRuntimeRef/#//apple_ref/c/func/objc_setAssociatedObject" title="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/ObjCRuntimeRef/#//apple_ref/c/func/objc_setAssociatedObject" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>ï¼š</p>
<blockquote>
<p><code>objc_setAssociatedObject</code>æ˜¯Objectiveï¼Cè¿è¡Œæ—¶çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥å°†ä¸¤ä¸ªå¯¹è±¡å…³è”èµ·æ¥ã€‚è¿™ä¸ªå‡½æ•°éœ€è¦å››ä¸ªå‚æ•°ï¼šåŸå¯¹è±¡ï¼Œä¸€ä¸ªé”®ï¼Œä¸€ä¸ªå€¼ï¼Œå’Œä¸€ä¸ªå…³è”ç­–ç•¥çš„å¸¸é‡ã€‚å…¶ä¸­ï¼Œé”®æ˜¯ä¸€ä¸ªvoidæŒ‡é’ˆã€‚</p>
<ul>
<li>æ¯ä¸ªå…³è”çš„é”®éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚é€šå¸¸çš„åšæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªé™æ€å˜é‡ã€‚</li>
<li>å…³è”ç­–ç•¥æŒ‡å®šäº†è¢«å…³è”çš„å¯¹è±¡æ˜¯assignedï¼Œretainedï¼Œcopiedè¿˜æ˜¯atomic/nonatomicã€‚è¿™ä¸ªå½¢å¼å’Œå£°æ˜propertyæ˜¯ç±»ä¼¼çš„ã€‚å¯ä»¥ç”¨å¸¸é‡æ¥æŒ‡å®šè¿™ç§å…³ç³»ã€‚</li>
</ul>
</blockquote>
<h4 id="2-ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨ï¼Ÿ"><a href="#2-ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨ï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨ï¼Ÿ"></a>2. ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨ï¼Ÿ</h4><p><a href="http://stackoverflow.com/a/16313377/1594792" title="http://stackoverflow.com/a/16313377/1594792" target="_blank" rel="external">abbood</a>å°†å®ƒçš„ä½¿ç”¨åœºæ™¯å½’ç»“ä¸ºå¦‚ä¸‹å‡ ç‚¹ï¼š</p>
<p>(1)ç»™ç±»åˆ«ï¼ˆcategoryï¼‰æ·»åŠ å®ä¾‹å˜é‡ã€‚</p>
<p>å‡è®¾ä½ æƒ³ç»™ä½ ä¸èƒ½ä¿®æ”¹çš„å¯¹è±¡ï¼ˆæ¯”å¦‚è¯´è‹¹æœå®˜æ–¹æä¾›çš„å¯¹è±¡ï¼ŒUIImageã€UILabelç¥é©¬çš„ã€‚æ³¨æ„ï¼šæˆ‘ä»¬è¿™é‡Œè®¨è®ºçš„æ˜¯ä¿®æ”¹å¯¹è±¡æœ¬èº«ï¼Œä¸åŒ…æ‹¬å°†å…¶å­ç±»åŒ–ã€‚ï¼‰çš„ç±»åˆ«ä¸­æ·»åŠ ä¸ªè‡ªå®šä¹‰çš„å±æ€§ï¼ˆ<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html" title="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html" target="_blank" rel="external">è¿™å‡ ä¹æ˜¯Objective-Cæœ€å¤§çš„ç¼ºç‚¹</a>ï¼‰ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æƒ³ç»™<code>UIImage</code>æ·»åŠ ä¸€ä¸ªtitleçš„å±æ€§ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// UIImage-Title.h:</span></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIImage</span>(<span class="title">Title</span>)</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *title;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="comment">// UIImage-Title.m:</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">char</span> titleKey;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIImage</span>(<span class="title">Title</span>)</span></div><div class="line">- (<span class="built_in">NSString</span> *)title</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;titleKey);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setTitle:(<span class="built_in">NSString</span> *)title</div><div class="line">&#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;titleKey, title, OBJC_ASSOCIATION_COPY);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>(2)åŠ¨æ€åœ°ç»™å¯¹è±¡æ·»åŠ çŠ¶æ€ä¿¡æ¯ï¼Œè€Œè¿™ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡å³ä¾¿ç»“åˆKVOä¹Ÿä¸èƒ½è¾¾åˆ°ç›®çš„ã€‚ï¼ˆæœ‰ç‚¹æ‹—å£ï¼Œæ…¢æ…¢ç†è§£ã€‚ã€‚ï¼‰</p>
<p>æ„æ€æ˜¯è¯´ï¼Œä½ çš„å¯¹è±¡åªæœ‰åœ¨runtimeæœŸé—´ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠ¨æ€åœ°ï¼‰æ‰èƒ½è·å–çŠ¶æ€ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œå°½ç®¡ä½ å¯ä»¥æŠŠçŠ¶æ€ä¿¡æ¯å­˜åœ¨å®ä¾‹å˜é‡ä¸­ï¼Œä½†å®é™…ä¸Šä½ æ˜¯è¦åœ¨runtimeæœŸé—´æŠŠè¿™ä¸ªä¿¡æ¯å’Œå¯¹è±¡ç»‘å®šèµ·æ¥ã€å¹¶ä¸”åŠ¨æ€åœ°æŠŠå®ƒå’Œå¦ä¸€ä¸ªå¯¹è±¡å…³è”ï¼Œè¦å¼ºè°ƒçš„æ˜¯<strong>è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åŠ¨æ€çŠ¶æ€</strong>è¿™ä¸ªäº‹å®ã€‚</p>
<p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªä¸é”™çš„<a href="https://github.com/alexzielenski/ZKRevealingTableViewCell/blob/master/vendor/ZKRevealingTableViewCell.m" title="https://github.com/alexzielenski/ZKRevealingTableViewCell/blob/master/vendor/ZKRevealingTableViewCell.m" target="_blank" rel="external">ä¾‹å­</a>ä¸­çš„ä¸€ä¸ªç‰‡æ®µï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå…³è”å¯¹è±¡ä½¿ç”¨äº†KVOé€šçŸ¥ï¼Œä½†KVOå¹¶ä¸æ˜¯å…³è”å¯¹è±¡çš„å¿…è¦æ¡ä»¶ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">char</span> BOOLRevealing;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)isRevealing</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> [(<span class="built_in">NSNumber</span>*)objc_getAssociatedObject(<span class="keyword">self</span>, &amp;BOOLRevealing) boolValue];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)_setRevealing:(<span class="built_in">BOOL</span>)revealing</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> willChangeValueForKey:<span class="string">@"isRevealing"</span>];</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;BOOLRevealing,</div><div class="line">       [<span class="built_in">NSNumber</span> numberWithBool:revealing], OBJC_ASSOCIATION_RETAIN_NONATOMIC);</div><div class="line">    [<span class="keyword">self</span> didChangeValueForKey:<span class="string">@"isRevealing"</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼•ä¸€æ®µ<em>SDWebImage</em>ä¸­çš„ä»£ç ï¼Œçº¯æ­£çš„ã€ä¸å«KVOçš„é•¿è¿™æ ·å­ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)setShowActivityIndicatorView:(<span class="built_in">BOOL</span>)show&#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;TAG_ACTIVITY_SHOW, [<span class="built_in">NSNumber</span> numberWithBool:show], OBJC_ASSOCIATION_RETAIN);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)showActivityIndicatorView&#123;</div><div class="line">    <span class="keyword">return</span> [objc_getAssociatedObject(<span class="keyword">self</span>, &amp;TAG_ACTIVITY_SHOW) boolValue];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œ<code>TAG_ACTIVITY_SHOW</code>çš„å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">char</span> TAG_ACTIVITY_SHOW;</div></pre></td></tr></table></figure></p>
<h4 id="3-æ­¤å¤„ä½œç”¨"><a href="#3-æ­¤å¤„ä½œç”¨" class="headerlink" title="3. æ­¤å¤„ä½œç”¨"></a>3. æ­¤å¤„ä½œç”¨</h4><p>æ‰€ä»¥ï¼Œè¿™é‡Œç›¸å½“äºç»™UIImageViewçš„categoryæ·»åŠ äº†ä¸€ä¸ª<code>imageURLKey</code>çš„å±æ€§ï¼Œæˆ‘çŒœæƒ³ï¼Œæ˜¯ç”¨æ¥è¡¨ç¤ºå›¾ç‰‡èµ„æºçš„å”¯ä¸€æ€§çš„keyã€‚</p>
<h3 id="ï¼»2ï¼½-amp"><a href="#ï¼»2ï¼½-amp" class="headerlink" title="ï¼»2ï¼½&amp;"></a>ï¼»2ï¼½&amp;</h3><h4 id="ä¸ºä»€ä¹ˆè¿™é‡Œç”¨-amp-è€Œä¸æ˜¯-amp-amp-å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¿™é‡Œç”¨-amp-è€Œä¸æ˜¯-amp-amp-å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¿™é‡Œç”¨&amp;è€Œä¸æ˜¯&amp;&amp;å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¿™é‡Œç”¨<code>&amp;</code>è€Œä¸æ˜¯<code>&amp;&amp;</code>å‘¢ï¼Ÿ</h4><p>è¶æœºæ¡ä¸€æ¡åŸºç¡€çŸ¥è¯†ï¼š</p>
<p><code>&amp;</code>æ˜¯æŒ‰ä½è¿ç®—çš„åŒç›®è¿ç®—ç¬¦ï¼ŒåŠŸèƒ½æ˜¯å‚ä¸å°†è¿ç®—çš„ä¸¤ä¸ªæ•°å„è‡ªå¯¹åº”çš„äºŒè¿›ä½ç›¸ä¸ã€‚<br>ä¾‹å¦‚ï¼š9&amp;5å¯ä»¥å†™ç®—å¼ï¼š00001001 &amp; 00000101 ï¼ 00000001ï¼Œå³ 9 &amp; 5 = 1ã€‚</p>
<p><code>&amp;&amp;</code>æ£€æŸ¥ç¬¬ä¸€ä¸ªæ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœä¸ºfalseï¼Œå°±ä¸å†å¤„ç†ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼Œç›´æ¥è¿”å›falseã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™é‡Œçš„<code>(options &amp; SDWebImageDelayPlaceholder)</code>ï¼Œæ˜¯ä¸¤ä¸ªæšä¸¾å€¼è¿›è¡ŒæŒ‰ä½è¿ç®—ï¼Œè€Œéæˆ‘ä»¬å¹³å¸¸å†™çš„true/falseçš„å¸ƒå°”åˆ¤æ–­ã€‚</p>
<p>éšæ‰‹ç‚¹å…¥æšä¸¾å€¼çš„å®šä¹‰ï¼Œå‘ç°è¿™ä¸€å †ï¼š<br><figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">typedef <span class="type">NS_OPTIONS</span>(<span class="type">NSUInteger</span>, <span class="type">SDWebImageOptions</span>) &#123;</div><div class="line">    /**</div><div class="line">     * <span class="type">By</span> default, when a <span class="type">URL</span> fail to be downloaded, the <span class="type">URL</span> is blacklisted so the library won't keep trying.</div><div class="line">     * <span class="type">This</span> flag disable this blacklisting.</div><div class="line">     */</div><div class="line">    <span class="type">SDWebImageRetryFailed</span> = 1 &lt;&lt; 0, // [3]</div><div class="line"></div><div class="line">    /**</div><div class="line">     * <span class="type">By</span> default, image downloads are started during <span class="type">UI</span> interactions, this flags disable this feature,</div><div class="line">     * leading to delayed download on <span class="type">UIScrollView</span> deceleration for instance.</div><div class="line">     */</div><div class="line">    <span class="type">SDWebImageLowPriority</span> = 1 &lt;&lt; 1,</div><div class="line"></div><div class="line">    /**</div><div class="line">     * <span class="type">This</span> flag disables on-disk caching</div><div class="line">     */</div><div class="line">    <span class="type">SDWebImageCacheMemoryOnly</span> = 1 &lt;&lt; 2,</div><div class="line">    ...</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>è€Œå…¶å®<code>SDWebImageDelayPlaceholder</code>æ­£æ˜¯è¿™ä¸€ç¾¤æšä¸¾å€¼ä¸­çš„ä¸€ä¸ªã€‚æ‰€ä»¥çŒœæµ‹ï¼Œè¿™å¥ä»£ç çš„æ„æ€æ˜¯è¯´ï¼Œä¼ å…¥çš„<code>option</code>ä¸ºåŒ…å«<code>SDWebImageDelayPlaceholder</code>æ—¶è¯¥å¦‚ä½•å¦‚ä½•â€¦â€¦ï¼ˆå¯ä¸ºå˜›æ›²æ›²æŠ˜æŠ˜åœ°ä¸ç›´è¯´å‘¢ï¼Ÿ=_=|||ï¼‰ ä½†è¿˜æ˜¯æ²¡æœ‰è§£å†³ä¸ºä»€ä¹ˆç”¨<code>&amp;</code>è€Œä¸ç”¨<code>&amp;&amp;</code>çš„é—®é¢˜ã€‚ä»”ç»†ä¸€çœ‹ï¼Œè¿™é‡Œçš„æšä¸¾å¹¶éè‡ªå·±å¹³æ—¶ä½¿ç”¨çš„<code>NS_ENUM</code>ï¼Œè€Œæ˜¯<code>NS_OPTIONS</code>ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒäºŒè€…æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œ<code>NS_ENUM</code>æ˜¯æ¯”è¾ƒé€šç”¨çš„æƒ…å†µï¼Œè€Œä½æ©ç æ—¶ç”¨<code>NS_OPTIONS</code>ï¼Œå…·ä½“çš„è§£é‡Šå¯ä»¥çœ‹<a href="http://nshipster.com/ns_enum-ns_options/" title="http://nshipster.com/ns_enum-ns_options/" target="_blank" rel="external">Matttçš„è¿™ç¯‡</a>ã€‚</p>
<p><strong> â€”â€”â€”â€” 20160216æ›´æ–°â€”â€”â€”â€” </strong><br>é‰´äºåæœŸè¶Šæ¥è¶Šå¤šçš„ä½è¿ç®—å‡ºç°ï¼Œè¿‡æœŸçš„è–„åº•å­holdä¸ä½äº†ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæ›´å¤šè¯¦ç»†ä»‹ç»å‚è€ƒ<a href="http://www.cnblogs.com/cute/p/3786283.html" title="http://www.cnblogs.com/cute/p/3786283.html" target="_blank" rel="external">è¿™ç¯‡</a>ã€‚<br><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">typedef NS_OPTIONS(NSUInteger, MyOption) &#123;</div><div class="line">    MyOptionNone = <span class="number">0</span>, <span class="comment">//äºŒè¿›åˆ¶0000,åè¿›åˆ¶0</span></div><div class="line">    MyOption1 = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,<span class="comment">//0001,1</span></div><div class="line">    MyOption2 = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,<span class="comment">//0010,2</span></div><div class="line">    MyOption3 = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,<span class="comment">//0100,4</span></div><div class="line">    MyOption4 = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,<span class="comment">//1000,8</span></div><div class="line">&#125;;</div><div class="line">##ä½¿ç”¨:</div><div class="line"><span class="comment">//å£°æ˜å®šä¹‰æšä¸¾å˜é‡</span></div><div class="line">MyOption option = MyOption1 | MyOption2;<span class="comment">//0001 | 0010 = 0011,3</span></div><div class="line"></div><div class="line"><span class="comment">//æ£€æŸ¥æ˜¯å¦åŒ…å«æŸé€‰å‹</span></div><div class="line">if ( <span class="keyword">option</span> &amp; MyOption3 )&#123; <span class="comment">//0011 &amp; 0100 = 0000</span></div><div class="line">     <span class="comment">//åŒ…å«MyOption3</span></div><div class="line">&#125;else&#123;</div><div class="line">     <span class="comment">//ä¸åŒ…å«MyOption3</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å¢åŠ é€‰é¡¹:</span></div><div class="line"><span class="keyword">option</span> = <span class="keyword">option</span> | MyOption4;<span class="comment">//0011 | 1000 = 1011, 11</span></div><div class="line"><span class="comment">//å‡å°‘é€‰é¡¹</span></div><div class="line"><span class="keyword">option</span> = <span class="keyword">option</span> &amp; (~MyOption4);<span class="comment">//1011 &amp; (~1000) = 1011 &amp; 0111 = 0011, 3</span></div></pre></td></tr></table></figure></p>
<p>æˆ‘çš„ç†è§£æ˜¯ï¼ŒBitwise <code>AND</code>ï¼Œå³<code>&amp;</code>ï¼Œç›¸å½“äºä¸¤ä¸ªoptionå–äº¤é›†ï¼›Bitwise <code>OR</code>ï¼Œå³<code>|</code>ï¼Œç›¸å½“äºä¸¤ä¸ªoptionå–å¹¶é›†ã€‚</p>
<p>å…³äº<code>NS_OPTIONS</code>å’Œ<code>NS_ENUM</code>çš„å·®åˆ«ï¼Œåæ¥æŸ¥åˆ°çš„orkodençš„<a href="http://stackoverflow.com/a/21384671/1594792" target="_blank" rel="external">å›ç­”</a>ä¸€è¯­ä¸­çš„ğŸ˜‚ï¼š</p>
<blockquote>
<p>Thereâ€™s a basic difference between an enum and a bitmask (option). You use an enum to list exclusive states. A bitmask is used when several properties can apply at the same time.</p>
</blockquote>
<p><strong> â€”â€”â€”â€” 20160216æ›´æ–°ç»“æŸâ€”â€”â€”â€” </strong></p>
<h3 id="ï¼»3ï¼½-lt-lt"><a href="#ï¼»3ï¼½-lt-lt" class="headerlink" title="ï¼»3ï¼½\&lt;\&lt;"></a>ï¼»3ï¼½\&lt;\&lt;</h3><p><code>&lt;&lt;</code>ä¸ºæŒ‰ä½å·¦ç§»è¿ç®—ç¬¦ã€‚å…·ä½“å®ƒ<a href="http://stackoverflow.com/questions/141525/what-are-bitwise-shift-bit-shift-operators-and-how-do-they-work" title="http://stackoverflow.com/questions/141525/what-are-bitwise-shift-bit-shift-operators-and-how-do-they-work" target="_blank" rel="external">æ˜¯ä»€ä¹ˆä»¥åŠæ€æ ·è¿ç®—</a>ï¼Œè¿™é‡Œç•¥å»ä¸æäº†ã€‚ç®€å•ä¸¾ä¾‹å¦‚ä¸‹ï¼š<br>SDWebImageAvoidAutoSetImage<br>    1 &lt;&lt; 2 å³ äºŒè¿›åˆ¶çš„100 ï¼ åè¿›åˆ¶ 2çš„å¹³æ–¹<br>    1 &lt;&lt; 3 å³ äºŒè¿›åˆ¶çš„1000 ï¼ åè¿›åˆ¶ 2çš„3æ¬¡æ–¹</p>
<p>æ‰€ä»¥ï¼Œ<code>1 &lt;&lt; n</code>ï¼Œå³äºŒè¿›åˆ¶1å·¦ä½ç§»nä½ï¼Œç›¸å½“äºåè¿›åˆ¶2çš„næ¬¡æ–¹ã€‚</p>
<h3 id="ï¼»4ï¼½å®å®šä¹‰"><a href="#ï¼»4ï¼½å®å®šä¹‰" class="headerlink" title="ï¼»4ï¼½å®å®šä¹‰"></a>ï¼»4ï¼½å®å®šä¹‰</h3><p><code>dispatch_main_sync_safe</code>å’Œ<code>dispatch_main_async_safe</code>æ˜¯SDWebImageå®šä¹‰çš„ä¸¤ä¸ªå®ã€‚è‹¥å½“å‰æ˜¯ä¸»çº¿ç¨‹ï¼Œåˆ™æ‰§è¡Œblockï¼›è‹¥ä¸æ˜¯ä¸»çº¿ç¨‹ï¼Œåˆ™åœ¨ä¸»çº¿ç¨‹ä¸­åŒæ­¥/å¼‚æ­¥ä¹‹è¡Œblockã€‚<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#define dispatch_main_sync_safe(block)\</span></div><div class="line">    <span class="keyword">if</span> ([NSThread isMainThread]) &#123;<span class="string">\</span></div><div class="line">        block();<span class="string">\</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;<span class="string">\</span></div><div class="line">        dispatch_sync(dispatch_get_main_queue(), block);<span class="string">\</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="comment">#define dispatch_main_async_safe(block)\</span></div><div class="line">    <span class="keyword">if</span> ([NSThread isMainThread]) &#123;<span class="string">\</span></div><div class="line">        block();<span class="string">\</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;<span class="string">\</span></div><div class="line">        dispatch_async(dispatch_get_main_queue(), block);<span class="string">\</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>æ¯è¡Œåé¢çš„åæ–œæ <code>\</code>è¡¨ç¤ºåœ¨ä¸å½±å“å«ä¹‰çš„æ¡ä»¶ä¸‹æ¢è¡Œï¼Œéœ€æ³¨æ„è¦åœ¨å›è½¦ä¹‹å‰åŠ åæ–œæ <code>\</code>ã€‚</p>
<p>å†çœ‹ä¸€ä¸ªå¸¸è§çš„å®å®šä¹‰ã€‚<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#define DLog(<span class="name">fmt</span>, ...)    NSLog( @<span class="string">"&lt;%@:(%d)&gt; %s \n ----- %@"</span>, [[NSString stringWithUTF8String<span class="symbol">:__FILE__</span>] lastPathComponent], __LINE__, __func__, [NSString stringWithFormat:(<span class="name">fmt</span>), ##__VA_ARGS__] )</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªç”¨äºLogçš„å®å®šä¹‰ä¸­ï¼Œæœ‰è¿™æ ·å‡ ç‚¹éœ€è¦è§£é‡Šçš„ï¼š</p>
<ul>
<li><code>DLog(fmt, ...)</code>çš„ç¬¬äºŒä¸ªå‚æ•°<code>...</code>ã€‚åœ¨å®å®šä¹‰çš„æ—¶å€™ï¼Œå†™ä¸ºâ€¦çš„å‚æ•°è¢«å«åšå¯å˜å‚æ•°(variadic)ï¼Œå…¶ä¸ªæ•°æ˜¯ä¸é™å®šçš„ã€‚åœ¨è¿™é‡Œï¼Œç¬¬ä¸€ä¸ªå‚æ•°fmtå°†è¢«å•ç‹¬å¤„ç†ï¼Œåé¢çš„å‚æ•°å°†è¢«ä½œä¸ºæ•´ä½“çœ‹å¾…ã€‚</li>
<li>é€šå¸¸å‰åè¢«<code>__</code>åŒ…å›´çš„éƒ½æ˜¯é¢„å®šä¹‰å®ã€‚å¦‚è¿™é‡Œçš„<code>__FILE__</code>ï¼ˆå½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼‰ï¼Œ<code>__LINE__</code>ï¼ˆåœ¨æ–‡ä»¶ä¸­çš„è¡Œæ•°ï¼‰ï¼Œ<code>__func__</code>ï¼ˆè¯¥å®æ‰€åœ¨çš„è¡Œæ‰€å±çš„å‡½æ•°åï¼‰ã€‚</li>
<li><code>##__VA_ARGS__</code>è¡¨ç¤ºçš„æ˜¯å®å®šä¹‰ä¸­çš„â€¦ä¸­çš„æ‰€æœ‰å‰©ä½™å‚æ•°ã€‚æ‰“å¤´çš„<code>##</code>è¡¨ç¤ºå°†ä¸¤ä¸ªå‚æ•°è¿æ¥èµ·æ¥è¿™ç§è¿ç®—ã€‚</li>
</ul>
<h3 id="ï¼»5ï¼½SDWebImageOptionsä¸­å‡ ä¸ªæœ‰è¶£çš„æšä¸¾å€¼"><a href="#ï¼»5ï¼½SDWebImageOptionsä¸­å‡ ä¸ªæœ‰è¶£çš„æšä¸¾å€¼" class="headerlink" title="ï¼»5ï¼½SDWebImageOptionsä¸­å‡ ä¸ªæœ‰è¶£çš„æšä¸¾å€¼"></a>ï¼»5ï¼½<code>SDWebImageOptions</code>ä¸­å‡ ä¸ªæœ‰è¶£çš„æšä¸¾å€¼</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">typedef NS_OPTIONS(NSUInteger, SDWebImageOptions) &#123;</div><div class="line">    ...</div><div class="line">    /**</div><div class="line">     * By default, placeholder images are loaded <span class="keyword">while</span> <span class="keyword">the</span> image <span class="keyword">is</span> loading. This flag will <span class="built_in">delay</span> <span class="keyword">the</span> loading</div><div class="line">     * <span class="keyword">of</span> <span class="keyword">the</span> placeholder image <span class="keyword">until</span> <span class="keyword">after</span> <span class="keyword">the</span> image has finished loading.</div><div class="line">     */</div><div class="line">    SDWebImageDelayPlaceholder = <span class="number">1</span> &lt;&lt; <span class="number">9</span>,</div><div class="line">    ...</div><div class="line">        /**</div><div class="line">     * By default, image <span class="keyword">is</span> added <span class="keyword">to</span> <span class="keyword">the</span> imageView <span class="keyword">after</span> download. But <span class="keyword">in</span> <span class="keyword">some</span> cases, we want <span class="keyword">to</span></div><div class="line">     * have <span class="keyword">the</span> hand <span class="keyword">before</span> setting <span class="keyword">the</span> image (apply a filter <span class="keyword">or</span> add <span class="keyword">it</span> <span class="keyword">with</span> cross-fade animation <span class="keyword">for</span> instance)</div><div class="line">     * Use this flag <span class="keyword">if</span> you want <span class="keyword">to</span> manually <span class="keyword">set</span> <span class="keyword">the</span> image <span class="keyword">in</span> <span class="keyword">the</span> completion when success</div><div class="line">     */</div><div class="line">    SDWebImageAvoidAutoSetImage = <span class="number">1</span> &lt;&lt; <span class="number">11</span></div></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢æåˆ°çš„<strong>æ ¸å¿ƒæ–¹æ³•</strong>ä¸­ï¼Œæœ‰è¿™æ ·å‡ ä¸ª<code>SDWebImageOptions</code>å¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚</p>
<p>ä¸€ä¸ªæ˜¯<code>SDWebImageDelayPlaceholder</code>ã€‚è¯´æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œplaceholderçš„å›¾ç‰‡ä¼šåœ¨ç½‘ç»œå›¾ç‰‡åŠ è½½çš„è¿‡ç¨‹ä¸­å°±è¢«åŠ è½½å®Œæ¯•ï¼Œè¿™ä¸ªflagä¼šå°†placeholderå›¾ç‰‡ç­‰åŠ è½½å»¶è¿Ÿåˆ°ç½‘ç»œå›¾ç‰‡å®ŒæˆåŠ è½½ä¹‹åã€‚æ‰€ä»¥è¿™é‡Œ<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">if</span> (!(options &amp; SDWebImageDelayPlaceholder)) &#123; <span class="comment">// [2]</span></div><div class="line">    dispatch_main_async_safe(^&#123;</div><div class="line">        self.<span class="built_in">image</span> = placeholder;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ˜¯è¯´å¦‚æœä½¿ç”¨è€…ä¼ å…¥çš„<code>options</code>ä¸æ˜¯<code>SDWebImageDelayPlaceholder</code>ï¼Œå°±æ­£å¸¸åœ°æŠŠplaceholderå›¾ç‰‡èµ‹ç»™å½“å‰çš„<code>imageView</code>ã€‚ä¹‹å‰ç¬¬ä¸€éçœ‹æ—¶æ²¡æœ‰çœ‹æ‡‚ï¼ŒåŸæ¥å°±æ˜¯â€œè´Ÿè´Ÿå¾—æ­£â€çš„æ„æ€ã€‚</p>
<p>å¦ä¸€ä¸ªæ˜¯<code>SDWebImageAvoidAutoSetImage</code>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå›¾ç‰‡ä¼šåœ¨ä¸‹è½½å®Œæ¯•å<em>è‡ªåŠ¨</em>æ·»åŠ ç»™<code>imageView</code>ã€‚ä½†æœ‰äº›æ—¶å€™ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æƒ³åœ¨è®¾ç½®å›¾ç‰‡ä¹‹å‰åŠ ä¸€äº›å›¾ç‰‡å¤„ç†ï¼ˆåŠ ä¸ªæ»¤é•œæˆ–è€…æ¸å˜åŠ¨ç”»ä¹‹ç±»çš„ï¼‰ï¼Œå°±éœ€è¦åœ¨ä¸‹è½½æˆåŠŸæ—¶<em>æ‰‹åŠ¨</em>ä½¿ç”¨è¿™ä¸ªflagæ¥è®¾ç½®å›¾ç‰‡äº†ã€‚<strong>ä»¥åæƒ³å®ç°ç±»ä¼¼æ•ˆæœå°±çŸ¥é“è¯¥åœ¨å“ªé‡Œè®¾ç½®ä»€ä¹ˆå‚æ•°äº†ã€‚</strong><br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="built_in">image</span> &amp;&amp; (options &amp; SDWebImageAvoidAutoSetImage) &amp;&amp; completedBlock)</div><div class="line">&#123;</div><div class="line">        completedBlock(<span class="built_in">image</span>, <span class="built_in">error</span>, cacheType, url);</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥è¿™é‡Œåˆ¤æ–­ï¼Œå¦‚æœimageä¸ä¸ºç©ºï¼Œè€Œ<code>options</code>è¡¨æ˜éœ€è¦å¢åŠ å›¾ç‰‡å¤„ç†ï¼Œä¸”åŠ è½½å®Œæˆçš„<code>completeBlock</code>ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°±ä»£å…¥å‚æ•°ï¼Œæ‰§è¡Œ<code>completeBlock</code>ã€‚</p>
<h3 id="ï¼»6ï¼½setNeedsLayoutå’ŒlayoutIfNeeded"><a href="#ï¼»6ï¼½setNeedsLayoutå’ŒlayoutIfNeeded" class="headerlink" title="ï¼»6ï¼½setNeedsLayoutå’ŒlayoutIfNeeded"></a>ï¼»6ï¼½<code>setNeedsLayout</code>å’Œ<code>layoutIfNeeded</code></h3><p>æ¥ç€ä¸Šé¢çš„ifåˆ¤æ–­ï¼š<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">else</span> <span class="built_in">if</span> (<span class="built_in">image</span>)</div><div class="line">&#123;</div><div class="line">         wself.<span class="built_in">image</span> = <span class="built_in">image</span>;</div><div class="line">         [wself setNeedsLayout];</div><div class="line">&#125;</div><div class="line"><span class="built_in">else</span> &#123;</div><div class="line">          <span class="built_in">if</span> ((options &amp; SDWebImageDelayPlaceholder)) &#123;</div><div class="line">                  wself.<span class="built_in">image</span> = placeholder;</div><div class="line">                  [wself setNeedsLayout];</div><div class="line">          &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœåä¸¤ä¸ªæ¡ä»¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸æ»¡è¶³ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†imageèµ‹ç»™å½“å‰çš„<code>imageView</code>ï¼Œå¹¶è°ƒç”¨<code>setNeedsLayout</code>å°†å…¶æ ‡è®°ä¸ºéœ€è¦é‡æ–°å¸ƒå±€ï¼›å¦‚æœimageä¸ºç©ºï¼Œè€Œ<code>options</code>è¡¨æ˜éœ€è¦å»¶è¿ŸåŠ è½½placeholderå›¾ç‰‡ï¼Œé‚£ä¹ˆå°±å°†placeholderå›¾ç‰‡èµ‹ç»™å½“å‰<code>imageView</code>ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºéœ€è¦é‡æ–°å¸ƒå±€ã€‚</p>
<p>ä¸<code>setNeedsLayout</code>ç´§å¯†ç›¸å…³çš„<code>layoutIfNeeded</code>ç”¨äºå®ç°å¸ƒå±€ã€‚æ¯”å¦‚ä½¿ç”¨äº†AutoLayoutçš„<code>UITableViewCell</code>ä¸­ç»å¸¸ä¼šè¿™æ ·äºŒè€…è¿ç€å†™ï¼š<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)layoutSubviews</div><div class="line">&#123;</div><div class="line">    [<span class="meta">super layoutSubviews</span>];</div><div class="line"></div><div class="line">    [<span class="meta">self.contentView setNeedsLayout</span>];</div><div class="line">    [<span class="meta">self.contentView layoutIfNeeded</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å…·ä½“iOSç»˜åˆ¶UIçš„åŸç†åŠæ­¥éª¤ï¼Œè¿™é‡Œç®—æ˜¯ç»™è‡ªå·±æŒ–äº†ä¸ªå‘å§ï¼Œä»¥åçœ‹æ‡‚äº†ã€ç ”ç©¶æ˜ç™½äº†å†æ…¢æ…¢å¡«ä¸Šã€‚</p>
<hr>
<p><strong>Refï¼š</strong></p>
<ul>
<li><p><a href="http://stackoverflow.com/questions/5909412/what-is-objc-setassociatedobject-and-in-what-cases-should-it-be-used/16313377#16313377" target="_blank" rel="external">http://stackoverflow.com/questions/5909412/what-is-objc-setassociatedobject-and-in-what-cases-should-it-be-used/16313377#16313377</a></p>
</li>
<li><p>Matttçš„çœŸè¿¹ï¼š<a href="http://nshipster.com/associated-objects/" target="_blank" rel="external">http://nshipster.com/associated-objects/</a></p>
</li>
<li>ä¸­æ–‡ç‰ˆï¼š<a href="http://nshipster.cn/associated-objects/" target="_blank" rel="external">http://nshipster.cn/associated-objects/</a></li>
<li>å–µç¥è®²è§£å®å®šä¹‰é»‘é­”æ³•çš„ä¸€ç¯‡ï¼š<a href="http://onevcat.com/2014/01/black-magic-in-macro/" target="_blank" rel="external">http://onevcat.com/2014/01/black-magic-in-macro/</a></li>
<li>å…³äºä½è¿ç®—ï¼š<a href="http://www.cnblogs.com/cute/p/3786283.html" target="_blank" rel="external">http://www.cnblogs.com/cute/p/3786283.html</a></li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/01/28/essay-soul-in-programming-170127/">0127-æ‰€è°“æŠ€æœ¯çŸ¥è¯†ä½“ç³»</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-01-28
        </span></div>
    </header>

    <div class="post-content"><blockquote>
<p>æ­¦åŠŸç™¾è¯€ï¼Œä»¥æ„ä¸ºå…ˆï¼Œé‚£æ‰æ˜¯æ­¦åŠŸçš„ç²¾éª¨ç¥é«“ï¼›æ‹›å¼èº«æ³•ï¼Œéƒ½ä¸è¿‡æ˜¯çš®æ¯›è€Œå·²ã€‚è‹¥æ— ç²¾éª¨ï¼Œçš®æ¯›ä½•åœ¨ï¼Ÿä½†è‹¥å¾—äº†æ­¦é“ç¥é«“ã€‚å†å­¦çš®æ¯›ä¾¿æ˜¯æ˜“å¦‚åæŒäº†ã€‚ â€”â€”ã€Šæµ£èŠ±æ´—å‰‘å½•ã€‹</p>
</blockquote>
<p>æœ€è¿‘åœ¨æ€è€ƒæ„å»ºæŠ€æœ¯çŸ¥è¯†ä½“ç³»çš„é—®é¢˜ï¼Œè¯»åˆ°è¿™å¥ï¼Œå¿½ç„¶ç¦è‡³å¿ƒçµè€Œæœ‰æ‰€æ„Ÿã€‚</p>
<p>æ‰€è°“é«˜å¤§æ²‰é‡çš„åŸºç¡€çŸ¥è¯†ï¼Œå¦‚æ•°æ®åº“ã€è®¡ç®—æœºç½‘ç»œã€æ“ä½œç³»ç»Ÿã€æ•°æ®ç»“æ„ä¹‹ç±»ï¼Œæ— éæ˜¯ç›¸å½“äºæ­¦åŠŸä¸­çš„ç¥éŸµï¼Œå› ä¸ºä»–ä»¬ä¸ä¾é™„äºæŸç§è¯­è¨€è€Œå­˜åœ¨ï¼Œå¦‚æµæ°´ï¼Œç”Ÿç”Ÿä¸æ¯ã€‚è€Œå…·ä½“çš„æŸç§è¯­è¨€ã€æŸä¸€ç§å…·ä½“çš„é¢†åŸŸåˆ™æ˜¯é‚£ç™¾å®¶å…µå™¨æ’è¡Œæ¦œä¸Šçš„ä¸€ä½ï¼Œæœ‰å…¶é”ä¸å¯å½“çš„éƒ¨åˆ†ï¼Œä¹Ÿæœ‰çœ‹ä¼¼çº·ç¹å¤æ‚ä½†åˆé—¨æˆ·å¤§å¼€çš„éƒ¨åˆ†ã€‚</p>
<p>æ‰€è°“å¤§å­¦è€…ï¼Œæ— éæ˜¯åœ¨ç»ƒå°±æˆ‘ä»¬çš„åŸºæœ¬åŠŸï¼Œè®©æˆ‘ä»¬é¢†æ‚Ÿè®¡ç®—æœºæŠ€æœ¯çš„ç²¾é«“ï¼Œä¸è‡³äºä¸ºè¯­è¨€ã€æŠ€æœ¯ä¹‹ä¼—å¤šè¿·èŠ±äº†çœ¼ã€‚å¯æƒœï¼Œå½“åˆçš„æˆ‘ä»¬èº«åœ¨æ£®æ—è€Œä¸çŸ¥æ ‘æœ¨ï¼Œå™«ååš±ï¼</p>
<p>æ‰€ä»¥ï¼Œå¯¹äºæŠ€æœ¯çŸ¥è¯†ä½“ç³»ï¼Œä¸å¦¨ä¸¤æ¡è…¿èµ°è·¯ï¼Œä¸€æ–¹é¢ï¼Œåœ¨å…·ä½“çš„å®è·µä¸­ä¸æ–­æ·±æŒ–ï¼Œå¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆï¼Œæ¯”å¦‚ç ”ç©¶AFNetworkingçš„æºç ï¼Œå°±å¯ä»¥é¡ºä¾¿è¿½ç©¶ä¸€ä¸‹ç½‘ç»œä¼ è¾“çš„åŸç†ï¼›å¦ä¸€æ–¹é¢ï¼Œä»åŸºç¡€çŸ¥è¯†å…¥æ‰‹ï¼Œç³»ç»Ÿåœ°æ•´ç†ä¸€ä¸‹ç½‘ç»œè‡ªé¡¶å‘ä¸‹çš„ä¸ƒå±‚ç»“æ„ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ–¹èƒ½èä¼šè´¯é€šã€‚</p>
<p>æ›¾çœ‹æ…¶å†™è¿‡ï¼Œè¯´æ„å»ºçŸ¥è¯†ä½“ç³»å°±åƒæ˜¯çœ‹åœ°å›¾ï¼Œè¦ä¸æ–­åœ°æ”¾å¤§ã€ç¼©å°ï¼šæ”¾å¤§æ—¶ï¼Œä¸€ä¸ªå°é•‡éƒ½ä¼šå˜å¾—å¾ˆå¤§ï¼Œè¡—é“ã€æ¥¼æˆ¿ï¼Œäº‹æ— å·¨ç»†ï¼›ç¼©å°æ—¶ï¼Œçºµè§‚å…¨å›½ã€å…¨ä¸–ç•Œï¼Œæ¨ªå‘çš„æ¯”è¾ƒæ‰æœ‰æ„ä¹‰ã€‚å¦‚ä»Šæƒ³æ¥ï¼Œææœ‰æ‰€æ‚Ÿï¼Œç»ˆäºä»æ¥å—å˜æˆäº†ç†è§£ã€‚</p>
<p>äºæ˜¯ï¼Œä¾¿ä¸å†çƒ¦èºå¯¹äºæœåŠ¡å™¨æ–¹é¢çš„å­¦ä¹ è¯¥ä½¿ç”¨å“ªç§è¯­è¨€ã€å“ªç§æŠ€æœ¯ï¼Œå› ä¸ºä¸€é€šç™¾é€šï¼Œå…·ä½“çš„å“ªä¸€ç§å°±æ²¡é‚£ä¹ˆé‡è¦äº†ã€‚å²æœˆé•¿æ²³ä¸­ï¼Œç»ˆæ˜¯æœ‰é‚£ä¸€æ³¢åˆä¸€æ³¢çš„è¯­è¨€å’ŒæŠ€æœ¯å€’åœ¨æ²™æ»©ä¸Šï¼Œä¸å˜çš„ï¼Œæ˜¯åƒæ·˜ä¸‡æ¼‰çš„æ²³åº•é¹…åµï¼Œå†ç»å†²åˆ·è€Œæ—¥æ¸æ»‘æ¶¦ï¼Œç† ç† ç”Ÿè¾‰ã€‚</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/01/21/how-not-to-crash-8-infrastructure/">ã€è¯‘ã€‘å¦‚ä½•é¿å…ç¨‹åºå´©æºƒ-8ï¼šåŸºæœ¬æ¶æ„</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-01-21
        </span></div>
    </header>

    <div class="post-content"><p>åŸæ–‡é“¾æ¥ï¼š<a href="http://inessential.com/2015/06/10/how_not_to_crash_8_infrastructure" target="_blank" rel="external">http://inessential.com/2015/06/10/how_not_to_crash_8_infrastructure</a></p>
<hr>
<p>å³ä½¿ä½ è§‰å¾—è‡ªå·±çš„appæ˜¯æ— æ•…éšœçš„ï¼Œä½ ä¹Ÿéœ€è¦æ”¶é›†å´©æºƒæ—¥å¿— â€”â€” å› ä¸ºæ²¡æœ‰ä»€ä¹ˆæ˜¯æ— æ•…éšœçš„ï¼šåªæœ‰<em>å·²çŸ¥</em>çš„å´©æºƒbugæ˜¯å¯ä»¥é¿å…çš„ã€‚</p>
<p>æœ‰ä¸€äº›åšè¿™ç±»äº‹æƒ…çš„æœåŠ¡ï¼Œæˆ‘å°è¯•è¿‡çš„è¿˜éƒ½ä¸é”™ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œå°±ä¸åšç‰¹åˆ«æ¨èäº†ã€‚</p>
<p>æœ‰å‡ ç‚¹åŠŸèƒ½æ˜¯å®ƒåº”è¯¥å…·å¤‡çš„ï¼š</p>
<ol>
<li>å´©æºƒæ—¥å¿—è¢«æ”¶é›†çš„è¿‡ç¨‹ï¼Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨æŸ¥æ‰¾å®ƒä»¬å†å‘é€ç»™ä½ ã€‚å®ƒåº”è¯¥æ˜¯è‡ªåŠ¨åŒ–çš„ï¼ˆå¦‚æœåœ¨OS Xä¸Šï¼Œç”¨æˆ·å¯èƒ½ä¼šæ”¶åˆ°æç¤ºï¼›è€Œåœ¨iOSä¸Šæ²¡äººä¼šå¸Œæœ›è¢«å¼¹çª—ï¼‰ã€‚</li>
<li>è¦æœ‰ç»™å´©æºƒæ—¥å¿—åˆ†ç»„çš„æœºåˆ¶ï¼Œä½ å¾—åˆ°çš„åº”è¯¥æ˜¯æ¯ä¸€ç»„çš„æ±‡æ€»ï¼Œè¿™æ ·ä½ å°±èƒ½çŸ¥é“å“ªäº›ç»å¸¸å‡ºç°ï¼Œå“ªäº›ä¸ç»å¸¸å‡ºç°ã€‚</li>
<li>è¦èƒ½å¤Ÿç»™ä¸€ç»„é—®é¢˜æ ‡è®°ä¸ºå·²è§£å†³ã€‚</li>
</ol>
<p>å½“ç„¶ï¼Œä»…ä»…æ”¶é›†å´©æºƒæ—¥å¿—æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚ä½ åº”è¯¥å®šæœŸæŸ¥çœ‹å®ƒä»¬ã€‚ï¼ˆæˆ‘æ¯å¤©æ—©ä¸ŠæŸ¥çœ‹å´©æºƒæ—¥å¿—ã€‚ï¼‰</p>
<h4 id="Bugè·Ÿè¸ªå™¨"><a href="#Bugè·Ÿè¸ªå™¨" class="headerlink" title="Bugè·Ÿè¸ªå™¨"></a>Bugè·Ÿè¸ªå™¨</h4><p>è¦æœ‰ä¸€ä¸ªã€‚</p>
<p>å¯¹äºæˆ‘ç§äººçš„é¡¹ç›®ï¼Œæˆ‘ä¼šç»¼åˆä½¿ç”¨Lighthouseï¼ŒOmniOutlinerå’Œçº¸ç¬” â€”â€” å½“ç„¶ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•å·¥å…·ï¼Œåªè¦ä½ çš„å´©æºƒè®°å½•å½’æ€»åˆ°ä½ çš„bugè·Ÿè¸ªå™¨é‡Œé¢è€Œä¸ä¼šé—å¤±ã€‚</p>
<p>ï¼ˆLighthouseæ˜¯ä¸ªä¸é”™çš„bugè·Ÿè¸ªå™¨ã€‚æˆ‘å–œæ¬¢ç”¨OmniOutlineræ¥æ ‡è®°å¤§çš„æ–°åŠŸèƒ½æˆ–è€…å®Œæ•´çš„appï¼Œåœ¨é‚£é‡Œæˆ‘å¯ä»¥å»ºç«‹to doçš„äº‹ä»¶æ ‘ã€‚å¯¹äºçŸ­å‘¨æœŸçš„äº‹æƒ… â€”â€” æ¯”å¦‚å®Œæˆä¸€ä¸ª10æ­¥å°±å¯ä»¥å®Œæˆçš„ä»»åŠ¡ â€”â€” æˆ‘å–œæ¬¢ç”¨çº¸ç¬”ï¼Œå› ä¸ºä¾èµ–çŸ­æœŸè®°å¿†å¾ˆè®©äººç–²å€¦ï¼Œè€Œçº¸ç¬”ä¸ä¼šå¹²æ‰°å±å¹•ä¸Šçš„ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚ï¼‰</p>
<h4 id="é”™è¯¯å’Œè­¦å‘Š"><a href="#é”™è¯¯å’Œè­¦å‘Š" class="headerlink" title="é”™è¯¯å’Œè­¦å‘Š"></a>é”™è¯¯å’Œè­¦å‘Š</h4><p>Xcodeé»˜è®¤ä¸ä¼šæ‰“å¼€è¶³å¤Ÿçš„é”™è¯¯å’Œè­¦å‘Šã€‚æˆ‘å¼ºçƒˆæ¨è<a href="http://boredzo.org/blog/archives/2009-11-07/warnings" title="http://boredzo.org/blog/archives/2009-11-07/warnings" target="_blank" rel="external">Peter Hoseyçš„é›†åˆ</a>ã€‚</p>
<p>å…³é”®æ˜¯è¦ç§»é™¤ä½ ä»£ç ä¸­çš„<em>ä¸ç¡®å®šæ€§</em>ã€‚</p>
<p>å°±åƒæˆ‘æ¨èçš„ï¼Œæˆ‘æ›´è¿›ä¸€æ­¥ï¼šæˆ‘åƒå¯¹å¾…é”™è¯¯ä¸€æ ·å¯¹å¾…è­¦å‘Šã€‚æ˜¯çš„ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦‚æœè­¦å‘Šå­˜åœ¨æˆ‘ç”šè‡³ä¸èƒ½åœ¨æœ¬åœ°debug â€”â€” ä½†æ˜¯è¿™æ¡å®ˆåˆ™ç‰©æœ‰æ‰€å€¼ã€‚å®ƒæ„å‘³ç€æ— è®ºä½•æ—¶ï¼Œåªè¦æˆ‘çš„appåœ¨è¿è¡Œï¼Œå°±ä¸å­˜åœ¨ä»»ä½•è­¦å‘Šã€‚</p>
<h4 id="Instruments"><a href="#Instruments" class="headerlink" title="Instruments"></a>Instruments</h4><p>Instrumentséå¸¸æ£’ã€‚æŸ¥çœ‹ä½ çš„appåˆ†é…äº†å¤šå°‘çš„å†…å­˜æ˜¯ä¸ªå¥½ä¸»æ„ï¼ŒåŒæ—¶ï¼ŒæŸ¥çœ‹å†…å­˜æ³„æ¼ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>å¦‚æœä½ çš„appå´©æºƒäº†ï¼Œä½¿ç”¨Zombieså·¥å…·æ˜¯ä¸ªå¥½ä¸»æ„ã€‚ä½ çš„é—®é¢˜å¯èƒ½å’Œzombieså¹¶æ²¡æœ‰å…³ç³»ï¼Œä½†æ˜¯åœ¨æ€€ç–‘çš„è¿‡ç¨‹ä¸­ï¼Œæ’é™¤æ³•æ˜¯å¾ˆå€¼å¾—ä½¿ç”¨çš„ã€‚</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/01/19/commands-in-git/">å®ç”¨gitå‘½ä»¤</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-01-19
        </span></div>
    </header>

    <div class="post-content"><h4 id="çŠ¶æ€ç›¸å…³"><a href="#çŠ¶æ€ç›¸å…³" class="headerlink" title="çŠ¶æ€ç›¸å…³"></a>çŠ¶æ€ç›¸å…³</h4><ul>
<li>æ’¤é”€ <code>git commit</code> ä¹‹å‰çš„ <code>git add</code> ï¼š<code>git reset &lt;file&gt;</code></li>
<li>æ›¿æ¢æœ¬åœ°æ”¹åŠ¨ï¼Œä¼šä½¿ç”¨HEADä¸­çš„æœ€æ–°å†…å®¹æ›¿æ¢æ‰å·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œå·²æ·»åŠ åˆ°æš‚å­˜åŒºåŠæ–°æ–‡ä»¶éƒ½ä¸ä¼šå—åˆ°å½±å“ï¼š<code>git checkout -- &lt;filename&gt;</code></li>
<li>ä¸¢å¼ƒæœ¬åœ°æ‰€æœ‰æ”¹åŠ¨å’Œæäº¤ï¼Œè·å–æœåŠ¡å™¨æœ€æ–°ç‰ˆæœ¬å†å²ï¼Œå¹¶å°†æœ¬åœ°ä¸»åˆ†æ”¯æŒ‡å‘å®ƒï¼š<code>git fetch origin</code>, <code>git reset --hard origin/master</code></li>
</ul>
<h4 id="åˆ†æ”¯ç›¸å…³"><a href="#åˆ†æ”¯ç›¸å…³" class="headerlink" title="åˆ†æ”¯ç›¸å…³"></a>åˆ†æ”¯ç›¸å…³</h4><ul>
<li>æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ï¼š<code>git branch -a</code></li>
<li>æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ï¼š<code>git branch</code></li>
<li>åˆ›å»ºåˆ†æ”¯ï¼š<code>git branch newBranch</code></li>
<li>æŠŠåˆ†æ”¯æ¨åˆ°è¿œç¨‹åˆ†æ”¯ï¼š<code>git push origin newBranch</code></li>
<li>æŠŠè¿œç¨‹åˆ†æ”¯pullä¸‹æ¥ï¼š<code>git clone --branch develop --single-branch XXurl</code></li>
<li>åˆ‡æ¢åˆ†æ”¯ï¼š<code>git checkout newBranch</code></li>
<li>åˆ é™¤è¿œç¨‹åˆ†æ”¯: <code>git push origin --delete &lt;branchName&gt;</code></li>
<li>åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼š<code>git branch -D fixVersion</code></li>
<li>åˆå¹¶æ”¹åŠ¨å‰ï¼Œé¢„è§ˆå·®å¼‚ï¼š<code>git diff &lt;source_branch&gt; &lt;target_branch&gt;</code></li>
<li>æŸ¥çœ‹è¿œç¨‹ä¿¡æ¯ï¼š<code>git remote show origin</code><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">remote origin</div><div class="line">  Fetch URL: https:<span class="comment">//github.com/WilliamZang/reactivecocoa_practise.git</span></div><div class="line">  Push  URL: https:<span class="comment">//github.com/WilliamZang/reactivecocoa_practise.git</span></div><div class="line">  HEAD branch: master</div><div class="line">  Remote branches:</div><div class="line">    lesson1          tracked</div><div class="line">    lesson2          tracked</div><div class="line">    lesson3          tracked</div><div class="line">    lesson4          tracked</div><div class="line">    lesson5          tracked</div><div class="line">    lesson6          tracked</div><div class="line">    master           tracked</div><div class="line">    practise2        tracked</div><div class="line">    practise2_answer tracked</div><div class="line">    practise3        tracked</div><div class="line">    practise3_answer tracked</div><div class="line">  <span class="keyword">Local</span> branches configured <span class="keyword">for</span> <span class="string">'git pull'</span>:</div><div class="line">    master           merges <span class="keyword">with</span> remote master</div><div class="line">    practise2        merges <span class="keyword">with</span> remote practise2</div><div class="line">    practise2_answer merges <span class="keyword">with</span> remote practise2_answer</div><div class="line">  <span class="keyword">Local</span> refs configured <span class="keyword">for</span> <span class="string">'git push'</span>:</div><div class="line">    lesson6          pushes <span class="keyword">to</span> lesson6          (<span class="keyword">local</span> <span class="keyword">out</span> <span class="keyword">of</span> date)</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Cheatsheet"><a href="#Cheatsheet" class="headerlink" title="Cheatsheet"></a>Cheatsheet</h4><p><img src="http://7xkwcv.com1.z0.glb.clouddn.com/git-cheat-sheet.png" alt="git cheat sheet"></p>
<p>æºæ–‡ä»¶åœ¨<a href="http://rogerdudler.github.io/git-guide/files/git_cheat_sheet.pdf" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<hr>
<p><strong>Ref:</strong></p>
<p><a href="http://rogerdudler.github.io/git-guide/index.zh.html" target="_blank" rel="external">http://rogerdudler.github.io/git-guide/index.zh.html</a></p>
<p><a href="http://stackoverflow.com/questions/348170/undo-git-add-before-commit" target="_blank" rel="external">http://stackoverflow.com/questions/348170/undo-git-add-before-commit</a></p>
<p><a href="http://stackoverflow.com/questions/927358/how-do-you-undo-the-last-commit" target="_blank" rel="external">http://stackoverflow.com/questions/927358/how-do-you-undo-the-last-commit</a></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2016/01/19/commands-in-LLVM/">LLDBå¸¸ç”¨å‘½ä»¤</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-01-19
        </span></div>
    </header>

    <div class="post-content"><h4 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="headerlink" title="åŸºæœ¬å‘½ä»¤"></a>åŸºæœ¬å‘½ä»¤</h4><p><strong>poï¼š</strong> æ‰“å°å‡ºå¯¹è±¡çš„descriptionæè¿°ã€‚<br>è¿™é‡Œåˆ—å‡ºå‡ ä¸ªå¸¸ç”¨çš„åœºæ™¯ï¼š</p>
<ul>
<li>æŸ¥çœ‹KVOçš„è¯¦ç»†ä¿¡æ¯ï¼š</li>
</ul>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">po <span class="string">[observedObject observationInfo]</span></div></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹AutoLayoutå¸ƒå±€çš„viewçš„å±‚çº§ç»“æ„ï¼Œéœ€åœ¨<code>layoutSublayersOfLayer:</code>æ–¹æ³•ä¸­æ·»åŠ æ–­ç‚¹ã€‚è¯¦å‚<a href="http://www.calios.gq/2015/09/10/AutoLayout-debug/" target="_blank" rel="external">è¿™ç¯‡</a>ã€‚</li>
</ul>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">po <span class="string">[self _autolayoutTrace]</span></div></pre></td></tr></table></figure>
<p><strong>eï¼š</strong> åœ¨å½“å‰ç¨‹åºç¯å¢ƒä¸­ï¼Œæ‰§è¡Œä»»ä½•çš„è¡¨è¾¾å¼ï¼Œå¹¶ä¸”å¯ä»¥å®šä¹‰å’Œæ“ä½œå·²å­˜åœ¨çš„å˜é‡ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> e result = []</span></div></pre></td></tr></table></figure>
<h4 id="æ§åˆ¶æµå¿«æ·å‘½ä»¤"><a href="#æ§åˆ¶æµå¿«æ·å‘½ä»¤" class="headerlink" title="æ§åˆ¶æµå¿«æ·å‘½ä»¤"></a>æ§åˆ¶æµå¿«æ·å‘½ä»¤</h4><ul>
<li><code>n</code>ï¼ŒStep Over</li>
<li><code>s</code>, Step Into</li>
<li><code>finish</code>, Step Out</li>
<li><code>c</code>, æ¢å¤ç¨‹åºæ‰§è¡Œæ“ä½œ<br><code>thread return</code>ï¼šä¸ä½†å¯ä»¥ä½¿å½“å‰çš„å‡½æ•°è¿”å›ï¼Œè€Œä¸”è¿˜å¯ä»¥ä»»æ„ä¿®æ”¹å½“å‰å‡½æ•°çš„è¿”å›å€¼ï¼Œè€Œä¸ç®¡ä¼ è¿›æ¥çš„å‚æ•°å¦‚ä½•ã€‚</li>
</ul>
<h4 id="æ–­ç‚¹åˆ›å»ºå‘½ä»¤"><a href="#æ–­ç‚¹åˆ›å»ºå‘½ä»¤" class="headerlink" title="æ–­ç‚¹åˆ›å»ºå‘½ä»¤"></a>æ–­ç‚¹åˆ›å»ºå‘½ä»¤</h4><figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(lldb) breakpoint <span class="built_in">set</span> -f ViewController.swift -l <span class="number">28</span></div><div class="line">Breakpoint <span class="number">2</span>: <span class="keyword">where</span> = <span class="keyword">Example</span>`<span class="keyword">Example</span>.ViewController.viewDidLoad (<span class="keyword">Example</span>.ViewController)() -&gt; () + <span class="number">478</span> <span class="built_in">at</span> ViewController.swift:<span class="number">29</span>, address= <span class="number">0x000000010f74f61e</span></div></pre></td></tr></table></figure>
<p>ç®€å†™ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">b</span> ViewController<span class="selector-class">.swift</span>:<span class="number">28</span></div><div class="line"><span class="selector-tag">b</span> add ï¼ˆaddä¸ºå‡½æ•°åï¼‰</div></pre></td></tr></table></figure></p>
<h4 id="ä¸€ç‚¹Chisel"><a href="#ä¸€ç‚¹Chisel" class="headerlink" title="ä¸€ç‚¹Chisel"></a>ä¸€ç‚¹Chisel</h4><p>æŸ¥çœ‹å‘½ä»¤ç”¨æ³•ï¼š<code>help [command]</code></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">(lldb) help pviews</div><div class="line">Print <span class="keyword">the</span> recursion description <span class="keyword">of</span> ~&lt;aView&gt;~.</div><div class="line"></div><div class="line">Arguments:</div><div class="line">  ~&lt;aView&gt;~; Type: UIView*/NSView*; The view <span class="built_in">to</span> print <span class="keyword">the</span> description <span class="keyword">of</span>.</div><div class="line"></div><div class="line">Options:</div><div class="line">  <span class="comment">--up/-u ; Print only the hierarchy directly above the view, up to its window.</span></div><div class="line">  <span class="comment">--depth/-d ~&lt;depth&gt;~; Type: int; Print only to a given depth. 0 indicates infinite depth.</span></div><div class="line"></div><div class="line">Syntax: pviews \[<span class="comment">--up] \[--depth=depth] ~&lt;aView&gt;~</span></div><div class="line"></div><div class="line">This <span class="keyword">command</span> <span class="title">is</span> <span class="title">implemented</span> <span class="title">as</span> <span class="title">FBPrintViewHierarchyCommand</span> <span class="title">in</span> /<span class="title">usr</span>/<span class="title">local</span>/<span class="title">Cellar</span>/<span class="title">chisel</span>/<span class="title">1</span><span class="number">.2</span><span class="number">.0</span>/<span class="title">libexec</span>/<span class="title">commands</span>/<span class="title">FBPrintCommands</span>.<span class="title">py</span>.</div><div class="line"></div><div class="line">(LLDB adds <span class="keyword">the</span> next <span class="built_in">line</span>, sorry...)</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹viewçš„å±‚çº§ç»“æ„çš„ <em>åŸç”Ÿå‘½ä»¤</em>ï¼š</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(lldb) po <span class="comment">[<span class="comment">[<span class="comment">[UIApplication sharedApplication]</span> keyWindow]</span> recursiveDescription]</span></div></pre></td></tr></table></figure>
<p>Chiselçš„ç®€åŒ–ç‰ˆï¼š<code>pviews</code></p>
<ul>
<li>è¯­æ³•ä¸ºï¼š<code>pviews [--up] [--depth=depth] &lt;aView&gt;</code></li>
<li>å¯ä»¥æ·»åŠ ä»¥ä¸‹å‚æ•°ï¼š<ul>
<li>â€“up/-uï¼šåªæ‰“å°ç›´å±äºå½“å‰viewçš„å±‚çº§å…³ç³»ã€‚æœ€é«˜å±‚ä¸ºå®ƒçš„windowã€‚</li>
<li>â€“depth/-d <depth>ï¼šåªæ‰“å°æŒ‡å®šå±‚æ•°ï¼Œ0æ„å‘³ç€ä¸é™åˆ¶å±‚æ•°ã€‚</depth></li>
</ul>
</li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="xml">(lldb) pviews</span></div><div class="line"><span class="tag">&lt;<span class="name">UIWindow:</span> <span class="attr">0x7f994423a3a0</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">768</span> <span class="attr">1024</span>); <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">gestureRecognizers</span> = &lt;<span class="attr">NSArray:</span> <span class="attr">0x7f994423abc0</span>&gt;</span>; layer = <span class="tag">&lt;<span class="name">UIWindowLayer:</span> <span class="attr">0x7f9944239e90</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">UILayoutContainerView:</span> <span class="attr">0x7f9943d4a160</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">768</span> <span class="attr">1024</span>); <span class="attr">transform</span> = <span class="string">[0,</span> <span class="attr">-1</span>, <span class="attr">1</span>, <span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0</span>]; <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943d4a380</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITransitionView:</span> <span class="attr">0x7f9943d4bbc0</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">clipsToBounds</span> = <span class="string">YES;</span> <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943d4be00</span>&gt;</span>&gt;</div><div class="line">   |    |    | <span class="tag">&lt;<span class="name">UIViewControllerWrapperView:</span> <span class="attr">0x7f9943cb7b30</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943cb8380</span>&gt;</span>&gt;</div><div class="line">   |    |    |    | <span class="tag">&lt;<span class="name">UILayoutContainerView:</span> <span class="attr">0x7f994412f9c0</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">gestureRecognizers</span> = &lt;<span class="attr">NSArray:</span> <span class="attr">0x7f9943c67c30</span>&gt;</span>; layer = <span class="tag">&lt;<span class="name">CALayer:</span> <span class="attr">0x7f994412fba0</span>&gt;</span>&gt;</div><div class="line">   |    |    |    |    | <span class="tag">&lt;<span class="name">UINavigationTransitionView:</span> <span class="attr">0x7f9943c606f0</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">clipsToBounds</span> = <span class="string">YES;</span> <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c13890</span>&gt;</span>&gt;</div><div class="line">   |    |    |    |    |    | <span class="tag">&lt;<span class="name">UIViewControllerWrapperView:</span> <span class="attr">0x7f994426d090</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f994426ce70</span>&gt;</span>&gt;</div><div class="line">   |    |    |    |    |    |    | <span class="tag">&lt;<span class="name">UIView:</span> <span class="attr">0x7f994423db60</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f994423dad0</span>&gt;</span>&gt;</div><div class="line">   |    |    |    |    |    |    |    | <span class="tag">&lt;<span class="name">UICollectionView:</span> <span class="attr">0x7f9944838000</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">768</span>); <span class="attr">clipsToBounds</span> = <span class="string">YES;</span> <span class="attr">gestureRecognizers</span> = &lt;<span class="attr">NSArray:</span> <span class="attr">0x7f9944241220</span>&gt;</span>; layer = <span class="tag">&lt;<span class="name">CALayer:</span> <span class="attr">0x7f9944240a30</span>&gt;</span>; contentOffset: <span class="template-variable">&#123;0, -64&#125;</span><span class="xml">&gt; collection view layout: <span class="tag">&lt;<span class="name">UICollectionViewFlowLayout:</span> <span class="attr">0x7f994423fca0</span>&gt;</span></span></div><div class="line">   ... ...</div><div class="line"></div><div class="line">(lldb) pviews --up</div><div class="line"><span class="tag">&lt;<span class="name">UIWindow:</span> <span class="attr">0x7f994423a3a0</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">768</span> <span class="attr">1024</span>); <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">gestureRecognizers</span> = &lt;<span class="attr">NSArray:</span> <span class="attr">0x7f994423abc0</span>&gt;</span>; layer = <span class="tag">&lt;<span class="name">UIWindowLayer:</span> <span class="attr">0x7f9944239e90</span>&gt;</span>&gt;</div><div class="line"></div><div class="line">(lldb) pviews --depth=5 0x7f9943d4ad60</div><div class="line"><span class="tag">&lt;<span class="name">UITabBar:</span> <span class="attr">0x7f9943d4ad60</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">712</span>; <span class="attr">1024</span> <span class="attr">56</span>); <span class="attr">autoresize</span> = <span class="string">W+TM;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943d4b1a0</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">_UITabBarBackgroundView:</span> <span class="attr">0x7f994423b920</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">56</span>); <span class="attr">autoresize</span> = <span class="string">W;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f994423bae0</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">_UIBackdropView:</span> <span class="attr">0x7f994423bb00</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">56</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">_UIBackdropViewLayer:</span> <span class="attr">0x7f994423bdd0</span>&gt;</span>&gt;</div><div class="line">   |    |    | <span class="tag">&lt;<span class="name">_UIBackdropEffectView:</span> <span class="attr">0x7f994423c320</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">56</span>); <span class="attr">clipsToBounds</span> = <span class="string">YES;</span> <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CABackdropLayer:</span> <span class="attr">0x7f994423bac0</span>&gt;</span>&gt;</div><div class="line">   |    |    | <span class="tag">&lt;<span class="name">UIView:</span> <span class="attr">0x7f994423c4f0</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">1024</span> <span class="attr">56</span>); <span class="attr">hidden</span> = <span class="string">YES;</span> <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">autoresize</span> = <span class="string">W+H;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f994423c5b0</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">UITabBarButton:</span> <span class="attr">0x7f9943c8fd20</span>; <span class="attr">frame</span> = <span class="string">(309</span> <span class="attr">1</span>; <span class="attr">76</span> <span class="attr">55</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c923e0</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarSwappableImageView:</span> <span class="attr">0x7f9943c92900</span>; <span class="attr">frame</span> = <span class="string">(25.5</span> <span class="attr">7</span>; <span class="attr">25</span> <span class="attr">25</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c92b70</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarButtonLabel:</span> <span class="attr">0x7f9943c902f0</span>; <span class="attr">frame</span> = <span class="string">(24</span> <span class="attr">35</span>; <span class="attr">28</span> <span class="attr">17</span>); <span class="attr">text</span> = <span class="string">'é¦–é¡µ'</span>; <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c90590</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">UITabBarButton:</span> <span class="attr">0x7f9943c9bf20</span>; <span class="attr">frame</span> = <span class="string">(419</span> <span class="attr">1</span>; <span class="attr">76</span> <span class="attr">55</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c9d520</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarSwappableImageView:</span> <span class="attr">0x7f9943c9d910</span>; <span class="attr">frame</span> = <span class="string">(25.5</span> <span class="attr">8</span>; <span class="attr">25</span> <span class="attr">23</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c9d540</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarButtonLabel:</span> <span class="attr">0x7f9943c9c0c0</span>; <span class="attr">frame</span> = <span class="string">(24</span> <span class="attr">35</span>; <span class="attr">28</span> <span class="attr">17</span>); <span class="attr">text</span> = <span class="string">'è¯¾ç¨‹'</span>; <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943c9be40</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">UITabBarButton:</span> <span class="attr">0x7f9943ca5450</span>; <span class="attr">frame</span> = <span class="string">(529</span> <span class="attr">1</span>; <span class="attr">76</span> <span class="attr">55</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943ca6a50</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarSwappableImageView:</span> <span class="attr">0x7f9943ca6d40</span>; <span class="attr">frame</span> = <span class="string">(25.5</span> <span class="attr">7</span>; <span class="attr">25</span> <span class="attr">25</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943ca6a70</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarButtonLabel:</span> <span class="attr">0x7f9943ca55f0</span>; <span class="attr">frame</span> = <span class="string">(17</span> <span class="attr">35</span>; <span class="attr">42</span> <span class="attr">17</span>); <span class="attr">text</span> = <span class="string">'è®¨è®ºåŒº'</span>; <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943ca5370</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">UITabBarButton:</span> <span class="attr">0x7f9943caeaa0</span>; <span class="attr">frame</span> = <span class="string">(639</span> <span class="attr">1</span>; <span class="attr">76</span> <span class="attr">55</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943cb0070</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarSwappableImageView:</span> <span class="attr">0x7f9943cb0350</span>; <span class="attr">frame</span> = <span class="string">(26</span> <span class="attr">7.5</span>; <span class="attr">24</span> <span class="attr">24</span>); <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943cb0090</span>&gt;</span>&gt;</div><div class="line">   |    | <span class="tag">&lt;<span class="name">UITabBarButtonLabel:</span> <span class="attr">0x7f9943caec40</span>; <span class="attr">frame</span> = <span class="string">(31</span> <span class="attr">35</span>; <span class="attr">14</span> <span class="attr">17</span>); <span class="attr">text</span> = <span class="string">'æˆ‘'</span>; <span class="attr">opaque</span> = <span class="string">NO;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f9943cae9a0</span>&gt;</span>&gt;</div><div class="line">   | <span class="tag">&lt;<span class="name">UIImageView:</span> <span class="attr">0x7f994423d490</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">-0.5</span>; <span class="attr">1024</span> <span class="attr">0.5</span>); <span class="attr">autoresize</span> = <span class="string">W;</span> <span class="attr">userInteractionEnabled</span> = <span class="string">NO;</span> <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x7f994423d590</span>&gt;</span>&gt;</div></pre></td></tr></table></figure>
<p>åˆ·æ–°æ˜¾ç¤ºçš„åŸç”Ÿå‘½ä»¤ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(lldb) e (<span class="keyword">void</span>)[CATransaction <span class="built_in">flush</span>]</div></pre></td></tr></table></figure>
<p>Chiselçš„ç®€åŒ–ç‰ˆï¼š<code>caflush</code></p>
<hr>
<p><strong>Ref:</strong></p>
<ul>
<li><p>ä¸è°ƒè¯•å™¨å…±èˆ - LLDB çš„åå°”å…¹(objccn.io): <a href="http://objccn.io/issue-19-2/" target="_blank" rel="external">http://objccn.io/issue-19-2/</a></p>
</li>
<li><p>LLDBä½¿ç”¨ç¯‡ï¼ˆä¸Šï¼‰: <a href="http://www.dreamingwish.com/article/lldb-usage-a.html" target="_blank" rel="external">http://www.dreamingwish.com/article/lldb-usage-a.html</a></p>
</li>
<li><p>LLDBç¯‡2æ•™ä½ ä½¿ç”¨faceBookçš„chiselæ¥æé«˜è°ƒè¯•æ•ˆç‡: <a href="http://www.jianshu.com/p/b2371dd4443b#" target="_blank" rel="external">http://www.jianshu.com/p/b2371dd4443b</a></p>
</li>
<li><p><a href="http://swiftcafe.io/2015/09/05/lldb-debug/" target="_blank" rel="external">http://swiftcafe.io/2015/09/05/lldb-debug/</a></p>
</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2015/12/19/how-not-to-crash-7-dealing-with-nothing/">ã€è¯‘ã€‘å¦‚ä½•é¿å…ç¨‹åºå´©æºƒ-7ï¼šä»€ä¹ˆéƒ½ä¸åš</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2015-12-19
        </span></div>
    </header>

    <div class="post-content"><p>åŸæ–‡é“¾æ¥ï¼š<a href="http://inessential.com/2015/05/29/how_not_to_crash_7_dealing_with_nothin" target="_blank" rel="external">http://inessential.com/2015/05/29/how_not_to_crash_7_dealing_with_nothin</a></p>
<hr>
<p>è€ƒè™‘ä¸‹è¿™è¡Œä»£ç ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="section">[thing doStuff]</span><span class="comment">;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>thing</code>æ˜¯nilï¼Œæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ä¸ä¼šå´©æºƒã€‚ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿã€‚</p>
<p>ä½†æ˜¯ä½ ä¸èƒ½ç”±æ­¤æ¨æ–­nilåœ¨æ‰€æœ‰åœºæ™¯ä¸­éƒ½æ²¡æœ‰é—®é¢˜ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="section">[self doStuff:thing]</span><span class="comment">;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>thing</code>æ˜¯nilï¼Œæ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚æœå–å†³äº<code>doStuff:</code>çš„å®ç° â€”â€” å®ƒå¯èƒ½ä¼šå´©æºƒã€‚è€ƒè™‘ä¸‹è¿™è¡Œä»£ç ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">menuItem.title = thing<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>menuItem</code>æ˜¯ä¸€ä¸ªNSMenuItemå¯¹è±¡ï¼Œé‚£ä¹ˆå½“<code>thing</code>ä¸ºnilæ—¶å®ƒå°±ä¼šå´©æºƒã€‚NSMenuItemçš„å¤´æ–‡ä»¶æ²¡æœ‰æåˆ°è¿™ä¸ªï¼Œå°±è¿æ–‡æ¡£ä¸­ä¹Ÿåªæ˜¯ä¸€ç¬”å¸¦è¿‡ï¼ˆâ€œå¦‚æœä½ ä¸æƒ³è¦æ ‡é¢˜ï¼Œå°±ç”¨ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ä»£æ›¿ï¼ˆ@â€œâ€ï¼‰ï¼Œè€Œä¸æ˜¯nilã€‚â€ï¼‰</p>
<p>è¿™å°±æ„å‘³ç€ä½ éœ€è¦ä¿è¯<code>thing</code>æ˜¯éç©ºçš„ã€‚ä½ å¯èƒ½å¾ˆç¡®ä¿¡å®ƒæ˜¯éç©ºçš„ã€‚ä½†æ˜¯è€ƒè™‘ä¸‹æˆ‘æ›¾ç»é‡åˆ°çš„ä¸€ä¸ªä¾‹å­ï¼Œå½“<code>thing</code>æ˜¯ä¸€ä¸ªå­—ä½“çš„åå­—æ—¶æ€ä¹ˆåŠã€‚æˆ‘ä»ä¸ä¼šæƒ³åˆ°è·å–å­—ä½“åå­—çš„ç³»ç»ŸAPIä¼šè¿”å›nil â€”â€” é™¤éå®ƒå¶å°”è¿™ä¹ˆåšäº†ï¼ˆå½“ç„¶æ—¶å¾ˆå°‘å‘ç”Ÿï¼Œè€Œä¸”ä¸ç®¡æˆ‘åšä»€ä¹ˆï¼Œä»æœªåœ¨æˆ‘çš„æœºå™¨ä¸Šå‘ç”Ÿï¼‰ã€‚</p>
<p>éœ€è¦çŸ¥é“çš„æ˜¯ï¼š</p>
<p>Nilçš„æ¥å—è€…æ˜¯æ²¡é—®é¢˜çš„ â€”â€” åªè¦ä½ çš„ä»£ç å¯¹äºä»€ä¹ˆéƒ½ä¸åšæ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p>
<p>Nilä½œä¸ºå‚æ•°å¯èƒ½æ²¡é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æœ‰é—®é¢˜ã€‚å½“è°ƒç”¨ç³»ç»Ÿçš„APIæ—¶ï¼Œå¤´æ–‡ä»¶å’Œæ–‡æ¡£ä¸ä¼šæ€»æ˜¯å‘Šè¯‰ä½ å¯èƒ½å‘ç”Ÿä»€ä¹ˆã€‚ï¼ˆè¿™ä¸€ç‚¹å¯èƒ½ä¼šåœ¨ä»–ä»¬å……åˆ†åˆ©ç”¨<a href="https://developer.apple.com/swift/blog/?id=25" title="https://developer.apple.com/swift/blog/?id=25" target="_blank" rel="external"><code>_Nullable</code>å’Œ<code>_Nonnull</code></a>æ—¶æœ‰æ‰€æ”¹å–„ã€‚ï¼‰</p>
<p>ä¸è¦ç›¸ä¿¡ä»»ä½•äººã€‚</p>
<h4 id="æ–­è¨€"><a href="#æ–­è¨€" class="headerlink" title="æ–­è¨€"></a>æ–­è¨€</h4><p>æ–­è¨€æ˜¯ä¸€ç§è¯æ˜å‡è®¾å’Œéœ€æ±‚çš„ä¸é”™çš„æ–¹å¼ï¼Œä¹Ÿæ˜¯ç¡®ä¿å‡è®¾ä¸ºçœŸçš„æœ‰æ•ˆå·¥å…·ã€‚æ–­è¨€ä¸è¯¥åœ¨å‘å¸ƒç‰ˆæœ¬ä¸­è¿è¡Œï¼ˆè¯¦è§Xcodeè®¾ç½®ä¸­çš„ENABLE_NS_ASSERTIONSï¼‰ã€‚</p>
<p>æˆ‘æœ€å–œæ¬¢çš„ä¸€ä¸ªæ˜¯NSParameterAssertï¼Œæˆ‘å‡ ä¹ä¸“é—¨ç”¨å®ƒæ¥åšä¸èƒ½ä¸ºç©ºå‚æ•°çš„ä¸ºç©ºæ£€æŸ¥ã€‚</p>
<p>ç”¨èµ·æ¥è¶…çº§ç®€å•ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)someMethod:(<span class="keyword">id</span>)someParameter &#123;</div><div class="line">Â Â <span class="built_in">NSParameterAssert</span>(someParameter);</div><div class="line">Â Â â€¦<span class="keyword">do</span> whateverâ€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä»¥åæˆ‘å¯èƒ½å¼€å§‹ä½¿ç”¨<code>_Nullable</code>/<code>_Nonnull</code>æ³¨é‡Š<em>å’Œ</em>NSParameterAssertã€‚ä¸¤ä¸ªéƒ½ç”¨ã€‚ï¼ˆæœªæ¥æˆ‘å¯èƒ½ä¼šå†™äº›Swiftçš„ä»£ç ï¼Œé‚£æ—¶å€™å¯¹äºnilçš„å¤„ç†å°±æ˜¯å¦ä¸€å›äº‹äº†ã€‚ä½†æ˜¯é‚£ä¸æ˜¯æˆ‘ä»Šå¤©è°ˆè®ºçš„å†…å®¹ï¼Œä¸€éƒ¨åˆ†çš„åŸå› æ˜¯ï¼Œæˆ‘å¯¹äºSwiftè¿˜ä¸è¶³ä»¥ç§°ä¸ºä¸“å®¶ï¼Œä¸èƒ½ç»™å‡ºå¥½çš„å»ºè®®ã€‚ï¼‰</p>
<p>æˆ‘ä¹Ÿç»å¸¸ä½¿ç”¨NSAssertã€‚NSAssertéœ€è¦ä¸€ä¸ªè¡¨è¾¾å¼å’Œä¸€ä¸ªè¯„è®ºæ–‡å­— â€”â€” ä½†æˆ‘å¾ˆæ‡’ï¼Œæ€»æŠŠè¯„è®ºç½®ä¸ºç©ºã€‚ï¼ˆè¿™ç§æƒ…å†µä¸‹æ˜¯æ²¡é—®é¢˜çš„ã€‚ï¼‰<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSAssert(<span class="name">something</span> == somethingElse, <span class="literal">nil</span>)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>ï¼ˆå…³äºæ‡’æƒ°çš„ä¸€ç‚¹å»ºè®®ï¼šæ‡’çš„ç¨‹åºå‘˜ä»ä¸å†™å´©æºƒçš„bugï¼Œå› ä¸ºä»–ä»¬ä¸æƒ³ä¹‹åå†å›æ¥ä¿®å¤å®ƒä»¬ã€‚ï¼‰</p>
<h4 id="æˆ‘å–œæ¬¢çš„å´©æºƒçš„bug"><a href="#æˆ‘å–œæ¬¢çš„å´©æºƒçš„bug" class="headerlink" title="æˆ‘å–œæ¬¢çš„å´©æºƒçš„bug"></a>æˆ‘å–œæ¬¢çš„å´©æºƒçš„bug</h4><p>å‡ å¹´å‰ï¼Œæˆ‘çš„app NetNewsWireæœ‰ä¸€ä¸ªå´©æºƒæ—¥å¿—æ•æ‰è€…ã€‚åœ¨å¯åŠ¨åº”ç”¨æ—¶ï¼Œå®ƒä¼šä»ç£ç›˜ä¸­æŠ“å–æœ€æ–°çš„å´©æºƒæ—¥å¿—å‘é€ç»™æˆ‘ã€‚</p>
<p>éšç€ä¸€äº›OS Xç³»ç»Ÿçš„å‘å¸ƒï¼ˆæˆ‘æƒ³æ˜¯10.5ï¼‰è‹¹æœå…¬å¸ä¿®æ”¹äº†ç£ç›˜ä¸­å´©æºƒæ—¥å¿—çš„å½¢å¼ã€‚æˆ‘æƒ³å®ƒä»¬æ›¾ç»æ˜¯æ¯ä¸ªåº”ç”¨ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œç„¶åè‹¹æœæ”¹æˆäº†æ¯æ¬¡å´©æºƒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚æˆ‘ä¸å¾—ä¸å†™äº›æ–°çš„ä»£ç æ¥å¤„ç†æ–°çš„å½¢å¼ã€‚</p>
<p>æˆ‘åšäº†ä¿®æ”¹ã€‚å‘ç»™äº†betaç‰ˆçš„æµ‹è¯•è€…ï¼Œä»–ä»¬ä¸“é—¨ç”¨è¿™ä¸ªappã€‚å‡ å‘¨è¿‡å»äº†ã€‚ä¸€åˆ‡å®‰å¥½ã€‚</p>
<p>ç„¶åï¼Œå°±åœ¨æˆ‘å‘å¸ƒè¿™ä¸ªç‰ˆæœ¬çš„å½“å¤©ï¼Œæˆ‘æ¥åˆ°äº†æˆåƒä¸Šä¸‡çš„æŠ¥å‘Šè€…è¯´ï¼Œâ€œåœ¨å¯åŠ¨åº”ç”¨çš„æ—¶å€™å°±æŒ‚æ‰äº†ï¼ä½†æ˜¯å†æ¬¡å¯åŠ¨çš„æ—¶å€™å°±å¥½äº†ã€‚â€</p>
<p>è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼šæ–°çš„ä»£ç ä¼šåœ¨æ ¹æœ¬æ²¡æœ‰å´©æºƒæ—¥å¿—çš„æ—¶å€™å´©æºƒæ‰ã€‚ç„¶åï¼Œåœ¨ä¸‹æ¬¡å¯åŠ¨çš„æ—¶å€™ â€”â€” æ—¢ç„¶æœ‰äº†å´©æºƒæ—¥å¿— â€”â€”å®ƒå°±ä¸ä¼šå´©æºƒäº†ã€‚ï¼ˆæ˜¯çš„ï¼Œè¿™æ˜¯ä¸ªå¯ä»¥è‡ªæ„ˆçš„å´©æºƒbugã€‚åœ¨å´©æºƒæ—¥å¿—æ•æ‰å™¨å†…ã€‚å°±æ˜¯è¿™æ ·ã€‚ï¼‰</p>
<p>å½“ç„¶è¿™å°±æ„å‘³ç€å¯¹æ‰€æœ‰<em>æ–°</em>ç”¨æˆ·æ¥è¯´ï¼Œå®ƒä¼šç«‹å³å´©æºƒï¼Œè€Œä¸åªæ˜¯é‚£äº›è¶³å¤Ÿå¹¸è¿ã€ä»æœªå´©æºƒè¿‡çš„äººä»¬ã€‚</p>
<p>è¿™å¯¹æˆ‘æ˜¯ä¸ªæå¤§çš„æé†’ï¼š<em>ä¸€å®šè¦è€ƒè™‘ä»€ä¹ˆéƒ½æ²¡æœ‰çš„æƒ…å†µ</em>ã€‚æ€»æ˜¯ä»€ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ä»€ä¹ˆéƒ½æ²¡æœ‰æ˜¯å¾ˆå¹³å¸¸çš„ã€‚ä½†æ˜¯å¯èƒ½éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä¹Ÿåº”è¯¥è¢«è€ƒè™‘åˆ°ã€‚</p>
<h4 id="ä¸€ä¸ªæ²¡é‚£ä¹ˆé…·çš„å´©æºƒbug"><a href="#ä¸€ä¸ªæ²¡é‚£ä¹ˆé…·çš„å´©æºƒbug" class="headerlink" title="ä¸€ä¸ªæ²¡é‚£ä¹ˆé…·çš„å´©æºƒbug"></a>ä¸€ä¸ªæ²¡é‚£ä¹ˆé…·çš„å´©æºƒbug</h4><p>æˆ‘è®¤ä¸ºè¿™ä¸ä¼šè½¬ç§» â€”â€” æˆ‘æƒ³å®ƒåªå­˜åœ¨äºbetaç‰ˆçš„ä»£ç ä¸­ã€‚</p>
<p>Vesperçš„åŒæ­¥ä¼šä¸æœåŠ¡å™¨å¯¹è¯ã€‚æœåŠ¡å™¨å°†JSONæ•°æ®è¿”å›ã€‚Cocoaçš„JSONè§£æå™¨å°†JSONçš„nullè½¬åŒ–æˆ<code>NSNull</code>å¯¹è±¡ã€‚</p>
<p>VesperæœŸæœ›å¾—åˆ°ä¸€ä¸ªNSStringï¼Œå´å¾—åˆ°äº†ä¸€ä¸ªNSNullã€‚Vesperè¯•å›¾å¯¹NSNullè°ƒç”¨ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œç„¶åå®ƒå°±æŒ‚æ‰äº†ã€‚</p>
<p>è¡¨é¢ä¸Šçœ‹æ¥è¿™æ˜¯ä¸€ä¸ªéš¾å•ƒçš„éª¨å¤´ï¼Œå› ä¸ºä½ ä¸èƒ½ä¿è¯JSONç»™å‡ºçš„ç±»å‹æ˜¯ä½ æƒ³è¦çš„ã€‚ä½ éœ€è¦ä¸€ä¸ªstringï¼Œä½†å¾—åˆ°äº†ä¸€ä¸ªNSNullã€‚</p>
<p>æ˜¯çš„ï¼ŒNSNullæ˜¯ä½ å¸Œæœ›èƒ½å¤Ÿå°½é‡éš”ç¦»å¤„ç†çš„ä¼—å¤šå¯¹è±¡ä¸­çš„ä¸€ä¸ªã€‚å®ƒæ˜¯ä¸ªå››å¤„æ¸¸èµ°çš„é—®é¢˜ä»£ç ï¼ˆå°½ç®¡æˆ‘ä¸çŸ¥é“åœ¨JSONçš„nullçš„ä¾‹å­ä¸­ç±»ä¼¼çš„ä¾‹å­æ˜¯ä»€ä¹ˆï¼‰ã€‚ï¼ˆä½ ç»ä¸åº”è¯¥åœ¨JSONä¹‹å¤–ç‰¹æ„ä½¿ç”¨å®ƒã€‚å‡ ä¹ç»ä¸åº”è¯¥ã€‚ç»å¯¹å°‘ç”¨ã€‚æ¯”å¦‚è¯´å‡ å¹´ç”¨ä¸€æ¬¡ï¼Œè€Œä¸”å¾—æ˜¯ä½ çœŸçš„çœŸçš„ä¸å¾—ä¸ç”¨çš„æ—¶å€™ã€‚å¯èƒ½è¿é‚£æ ·éƒ½ä¸åº”è¯¥ç”¨ã€‚ï¼‰</p>
<p>è¿™å°±æ˜¯åƒæˆ‘<a href="http://www.caliosd.gq/2015/11/19/how-not-to-crash-4-threading/" title="http://www.caliosd.gq/2015/11/19/how-not-to-crash-4-threading/">ä¹‹å‰é‚£ç¯‡</a>æåˆ°çš„ï¼Œæˆ‘å–œæ¬¢æŠŠJSONè½¬åŒ–æˆä¸­é—´å¯¹è±¡çš„éƒ¨åˆ†åŸå› å§ã€‚è¿™ä¹ˆåšçš„ä¸€å¤§éƒ¨åˆ†å·¥ä½œå°±é›†ä¸­åœ¨å¤„ç†NSNullå¯¹è±¡ä¸Š â€”â€” æˆ‘ä¸æƒ³æŠŠå®ƒä»¬æ¸—é€åˆ°åº”ç”¨çš„å…¶å®ƒéƒ¨åˆ†ä¸Šå»ï¼Œé‚£æ ·æ‰€åˆ°ä¹‹å¤„éƒ½ä¼šå˜å¾—è„å…®å…®çš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦ä¸€ä¸ªè§‚ç‚¹æ˜¯ï¼š<em>åªè¦æ˜¯å†™æœåŠ¡å™¨ç«¯çš„äººï¼Œå°±æ˜¯ä½ ä¸å…±æˆ´å¤©çš„ä»‡äºº</em>ã€‚ä»–éå¸¸éå¸¸çš„æ¨ä½ ã€‚</p>
<p>åœ¨è¿™é‡Œï¼ŒVesperçš„æ¡ˆä¾‹ä¸­ï¼Œæ˜¯æˆ‘æ‰®æ¼”äº†è¿™æ ·çš„è§’è‰²ã€‚ä½†æˆ‘ä»ç„¶è¦å‡è®¾å†™æœåŠ¡å™¨é‚£å®¶ä¼™æŠŠå®Œæˆæˆ‘æœ¬äººå’Œäº‹ä¸šçš„æ‘§æ¯å½“ä½œä»–ä»¬çš„ç»ˆæç›®æ ‡ä¸€æ ·åœ°å†™ä»£ç ã€‚ï¼ˆå°½ç®¡æˆ‘äº†è§£é‚£ä¸ªå®¶ä¼™ï¼Œä»–å¾ˆé…·ã€‚ä»–å–œæ¬¢å°çŒ«å’ªã€‚ï¼‰åŒæ—¶ï¼Œé‚£ä¸æ„å‘³ç€åªæ£€æŸ¥NSNull â€”â€” ä¸ç®¡æ€æ ·å®ƒåœ¨JSONä¸­å¾ˆå¸¸è§ â€”â€” è€Œæ˜¯è¦å¯¹æ¯ä¸€éƒ¨åˆ†æ•°æ®çš„ç±»å‹éƒ½è°¨æ…å¤„ç†ã€‚</p>
<p>ä»»ä½•äº‹æƒ…éƒ½å¯èƒ½åœ¨ä¸ç¡®å®šçš„æ—¶é—´å˜æˆä¸å¯é¢„çŸ¥çš„äº‹æƒ…ã€‚</p>
<p>ï¼ˆå¹¶éä¸€è·¯é€šç•…ã€‚ä½ æœŸæœ›èƒ½å¤Ÿä¸€å¸†é£é¡º â€”â€” ä½†æ˜¯é‚£ä¹Ÿå¤ªå®¹æ˜“äº†ã€‚å¯èƒ½ä¸€è·¯ä¸‹æ¥ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ï¼‰</p>
<h4 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h4><p>åˆå§‹åŒ–ä½ çš„å˜é‡ã€‚å°±è¿™æ ·ã€‚å¦‚æœæˆ‘æ¯ä¿®å¤ä¸€ä¸ªä»…ä»…å°†å˜é‡åˆå§‹åŒ–ä¸ºnilå°±è§£å†³çš„å´©æºƒbugå°±èƒ½æ‹¿åˆ°ä¸€ä¸ªç¡¬å¸çš„è¯ â€”â€” é‚£æˆ‘å·²ç»æœ‰å¥½äº›ç¡¬å¸äº†ã€‚ä½ è‚¯å®šå¸Œæœ›ä¸è¦è·å¾—è¿™æ ·çš„ç¡¬å¸ã€‚</p>
<p>ä¸åˆå§‹åŒ–ä½ çš„å˜é‡å°±åƒåœ¨ç©æ±½æ²¹ï¼Œç„¶åè¿˜è¯´ï¼Œæ²¡é—®é¢˜çš„ï¼Œå› ä¸ºç«æŸ´åœ¨å£è¢‹é‡Œã€‚</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2015/12/15/pitfall-1/">Cellçš„å¤ç”¨æœºåˆ¶</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2015-12-15
        </span></div>
    </header>

    <div class="post-content"><h4 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h4><p>æœ€è¿‘è¸©åˆ°äº†ä¸€ä¸ªä»¥å‰æ²¡æœ‰æ³¨æ„çš„å‘ã€‚åœºæ™¯æ˜¯è¿™ä¸ªæ ·å­çš„ã€‚</p>
<blockquote>
<p>ä¸€ä¸ªUICollectionViewæœ‰ä¸ªè‡ªå®šä¹‰çš„UICollectionViewCellï¼ŒUICollectionViewCellä¸­æœ‰ä¸ªUITableViewï¼Œåœ¨ç‚¹å‡»UITableViewçš„cellæ—¶ï¼Œéœ€è¦å°†ç‚¹å‡»ä¹‹åæ›´æ–°çš„modelï¼ˆä¸ºä¸€ä¸ªNSArrayï¼‰ä¼ å‡ºæ¥ç»™UICollectionViewï¼ŒUICollectionViewç”¨ä¸€ä¸ªNSMutableDictionaryæ¥ã€‚<br>å‡è®¾ç”¨delegateä¸€å±‚å±‚ä¼ å‡ºæ¥ã€‚<br>ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ï¼š</p>
<ul>
<li>Cell0ä¸­ï¼Œç‚¹å‡»UITableViewçš„cellï¼Œä¼ å‡ºæ¥çš„å€¼ä¸º<code>@[@&quot;0&quot;]</code>ï¼ŒUICollectionViewæ¥åˆ°çš„å€¼ä¸º<code>@[@&quot;0&quot;]</code>ï¼Œæ›´æ–°åçš„å­—å…¸ä¸º<code>@{ 0 = (0);}</code>ï¼›</li>
<li>æ°´å¹³æ»‘åŠ¨collectionViewï¼Œæ˜¾ç¤ºCell1ï¼Œç‚¹å‡»UITableViewçš„cellï¼Œ UITableViewä¼ å‡ºæ¥çš„å€¼ä¸º<code>@[@&quot;1&quot;]</code>ï¼ŒUICollectionViewæ¥åˆ°çš„å€¼ä¸º<code>@[@&quot;1&quot;]</code>ï¼Œæ›´æ–°åçš„å­—å…¸ä¸º<code>@{ 0 = (0); 1 = (0);}</code>ï¼›</li>
<li>ç»§ç»­æ°´å¹³æ»‘åŠ¨collectionViewï¼Œæ˜¾ç¤ºCell2ï¼Œç‚¹å‡»UITableViewçš„cellï¼Œ UITableViewä¼ å‡ºæ¥çš„å€¼ä¸º<code>@[@&quot;6&quot;]</code>ï¼ŒUICollectionViewæ¥åˆ°çš„å€¼ä¸º<code>@[@&quot;6&quot;]</code>ï¼Œæ›´æ–°åçš„å­—å…¸ä¸º<code>@{ 0 = (6); 1 = (0); 2 = (6);}</code>ï¼›</li>
<li>é—®é¢˜å‡ºç°äº†ï¼Œkeyä¸º2çš„valueä¼šæŠŠkeyä¸º0çš„valueè¦†ç›–æ‰ã€‚</li>
<li>æ‰€ä»¥å‘¢ï¼Ÿ</li>
</ul>
</blockquote>
<p>ä¸€å…¥å°å‘æ·±ä¼¼æµ·ï¼Œä»æ­¤æ¸…é—²æ˜¯è·¯äººã€‚</p>
<p>æ­¤å¤„ç•¥å»åå‡ æ ¹é’ä¸ã€‚</p>
<p>è¿˜å¥½ï¼ŒæŸæ—¥æ­£åˆçš„å’–å•¡é¦™ä¸­ï¼Œçµå…‰é—ªç°ã€‚å¾ˆå¯èƒ½æ˜¯keyä¸º2çš„valueå’Œkeyä¸º0çš„valueå¯¹åº”ç›¸åŒçš„åœ°å€ã€‚æ‰€ä»¥ï¼Œ2çš„valueå°±æŠŠ0çš„valueç»™è¦†ç›–äº†ã€‚æ‰“æ–­ç‚¹ä¾æ¬¡æ‰“å°äº†ä¸€ä¸‹æ›´æ–°åå­—å…¸ä¸­å„ä¸ªå…ƒç´ çš„åœ°å€ï¼Œæœç„¶å¦‚æ­¤ã€‚</p>
<p>çˆ¬å‡ºæ¥äº†ã€‚</p>
<h4 id="åæ€"><a href="#åæ€" class="headerlink" title="åæ€"></a>åæ€</h4><p>å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„è¡¨é¢åŸå› ï¼Œå¯èƒ½æ˜¯ç”±äºUICollectionViewCellçš„å¤ç”¨æœºåˆ¶ã€‚åœ¨æ¯é¡µæ˜¾ç¤ºä¸€ä¸ªcellçš„æƒ…å†µä¸‹ï¼Œå½“æ˜¾ç¤ºindex0çš„cellï¼Œå‡è®¾å…¶ä¸­æˆå‘˜å˜é‡çš„æŒ‡å‘çš„åœ°å€ä¸º<em>0x00001</em>ï¼Œï¼›å½“æ˜¾ç¤ºindex2çš„cellæ—¶ï¼Œå¤ç”¨äº†index0çš„cellï¼ŒåŒæ ·ä¹Ÿå°±å¤ç”¨äº†å…¶ä¸­çš„æˆå‘˜å˜é‡ï¼Œå³ä¸Šæ–‡ä¸­ä¼ å‡ºæ¥çš„æ•°ç»„ã€‚è€Œåœ¨è°ƒç”¨delegateæ–¹æ³•æ—¶ï¼Œç›´æ¥å°±æŠŠè¿™ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚æ¥ä¸‹æ¥å±‚å±‚ä»£ç†å‡ºæ¥ï¼Œæœ€ç»ˆcollectionViewè·å¾—çš„å€¼ä¹Ÿæ˜¯æ¢æ±¤ä¸æ¢è¯åœ°æŒ‡å‘åŸæ¥æ•°ç»„çš„åœ°å€<em>0x00001</em>ã€‚æ‰€ä»¥å°±å¯¼è‡´UICollectionViewä¸­å­—å…¸keyä¸º0å’Œkeyä¸º2çš„å€¼ç›¸åŒã€‚</p>
<p>æ·±ç©¶åŸå› çš„è¯ï¼Œè¿˜æ˜¯ä»£ç çš„é˜²å¾¡æ€§ä¸å¼ºã€‚ä»åˆ«å¤„è·å–çš„å€¼ä¸åº”è¯¥æ‹¿è¿‡æ¥å°±ç›´æ¥ä½¿ç”¨ï¼Œè€Œåº”è¯¥å¤åˆ¶ç»™ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œä¹‹åè‡ªå·±ç»§ç»­ç”¨è¿™ä¸ªæ–°çš„å˜é‡ã€‚åè¿‡æ¥ï¼Œä½œä¸ºä¼ å‡ºå»çš„å‚æ•°ï¼Œæœ€å¥½ä¹Ÿèƒ½ç•¥å¾®å°è£…ä¸€ä¸‹ï¼Œä¸è¦æŠŠprivateçš„æˆå‘˜å˜é‡ç›´æ¥å°±ä¼ å‡ºå»ï¼Œé˜²æ­¢å¼•å…¥å¤–é¢çš„æ±¡æŸ“ã€‚</p>
<p><strong>PSï¼š</strong><br>å½“ç„¶ï¼Œå¯¹äºä»UITableViewä¼ å€¼å‡ºå»ï¼Œé€šçŸ¥æœºåˆ¶ä¼šæ›´æ–¹ä¾¿äº›ï¼Œå…å¾—ä¸€å±‚å±‚çš„å†™ä»£ç†ã€‚ä½†ä¹Ÿè¦æ³¨æ„åŒæ ·çš„é—®é¢˜ã€‚æé«˜è‡ªå·±ä»£ç çš„å¥å£®æ€§ã€‚</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2015/12/14/auto-layout-best-practices-for-minimum-pain/">ã€è¯‘ã€‘Auto Layoutçš„æœ€ä½³å®è·µ â€”â€” æ­¢ç–¼ç‰‡</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2015-12-14
        </span></div>
    </header>

    <div class="post-content"><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://medium.com/@NSomar/auto-layout-best-practices-for-minimum-pain-c130b2b1a0f6#.tqby1u8l4" target="_blank" rel="external">https://medium.com/@NSomar/auto-layout-best-practices-for-minimum-pain-c130b2b1a0f6#.tqby1u8l4</a></p>
<hr>
<p>Auto Layoutæ˜¯ä¸ªå¾ˆæ£’çš„å·¥å…·ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬ä¿æŒç¥å¿—æ¸…é†’ï¼Œè¿˜èƒ½è®©æˆ‘ä»¬è¿™äº›æ‡’äººä»¬åœ¨è®¾ç½®frameçš„æ—¶å€™è¿œç¦»â€œç¥å¥‡æ•°å­—â€ã€‚</p>
<p>ä½†æ˜¯ä»»ä½•æŠ€æœ¯éƒ½ä¸æ˜¯å®Œç¾æ— ç¼ºçš„ï¼Œæˆ‘å¿…é¡»å¾—è¯´æˆ‘èŠ±äº†å¤ªå¤šçš„æ—¶é—´æ¥debugé‚£äº›ç¼ºå¤±çš„çº¦æŸæ¡ä»¶ï¼Œæˆ–è€…å¯¹äºä¸€äº›è—åœ¨å±‚çº§ç»“æ„æ·±å¤„çš„è§†å›¾ï¼Œæ·»åŠ ä¸€ä¸ªå†²çªçš„çº¦æŸæ¡ä»¶å°±ä¼šæŠŠæ•´ä¸ªå¸ƒå±€æ¯æ‰ï¼Œå½“è¿™äº›äº‹æƒ…å‘ç”Ÿçš„æ—¶å€™ç®€ç›´æ˜¯å¤©å´©åœ°è£‚ï¼</p>
<p>åœ¨debugäº†æ— æ•°ä¸ªå°æ—¶çš„auto layoutçš„é—®é¢˜åï¼Œæˆ‘å‘ç°æ¯æ¬¡é€ æˆé—®é¢˜çš„éƒ½æ˜¯æˆ‘è‡ªå·±ï¼ˆæˆ–è€…æ˜¯ä½ è‡ªå·±ï¼ï¼‰ï¼Œè€Œé—®é¢˜çš„è§£å†³åŠæ³•æ€»æ˜¯ç›¸åŒçš„ï¼šéµä»auto layoutçš„æ–‡æ¡£å’Œè§„åˆ™ï¼</p>
<p>æˆ‘ä¼šåœ¨è¿™é‡ŒæŠŠæ­£ç¡®ä½¿ç”¨auto layoutçš„æœ€ä½³å®è·µè¯´ç»™ä½ å¬ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å…é™¤ä¸€äº›ç—›è‹¦äº†ã€‚</p>
<h4 id="UIViewçš„å­ç±»åº”è¯¥å®ç°intrinsicContentSizeæ–¹æ³•"><a href="#UIViewçš„å­ç±»åº”è¯¥å®ç°intrinsicContentSizeæ–¹æ³•" class="headerlink" title="UIViewçš„å­ç±»åº”è¯¥å®ç°intrinsicContentSizeæ–¹æ³•"></a>UIViewçš„å­ç±»åº”è¯¥å®ç°intrinsicContentSizeæ–¹æ³•</h4><p>æ¯ä¸ª<em>UIView</em>çš„å­ç±»éƒ½åº”è¯¥å®ç°<em>intrinsicContentSize</em>ï¼Œå¹¶ä¸”è¿”å›å®ƒè®¤ä¸ºåˆé€‚çš„å¤§å°ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ª<em>AwesomeView</em>ï¼Œè€Œä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªviewçš„é»˜è®¤å°ºå¯¸æ˜¯300x20ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆå†™ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-(<span class="built_in">CGSize</span>)intrinsicContentSize &#123;</div><div class="line"> <span class="keyword">return</span> <span class="built_in">CGSizeMake</span>(<span class="number">300</span>, <span class="number">20</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæˆ‘ä»¬ä¸çŸ¥é“viewçš„å®½åº¦ï¼Œæˆ‘ä»¬ä¼šç”¨<em>UIViewNoIntrinsicMetric</em>æ¥ä»£æ›¿ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGSize</span>)intrinsicContentSize &#123;</div><div class="line"> <span class="keyword">return</span> <span class="built_in">CGSizeMake</span>(<span class="built_in">UIViewNoIntrinsicMetric</span>, <span class="number">20</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>UIViewåŸºç±»çš„<em>updateConstraints</em>å®ç°ä¼šè°ƒç”¨<em>intrinsicContentSize</em>ï¼Œå®ƒä¼šä½¿ç”¨è¿”å›çš„å°ºå¯¸æ¥ç»™<em>AwesomeView</em>æ·»åŠ çº¦æŸæ¡ä»¶ã€‚</p>
<p>æ ¹æ®ä¸Šé¢ä¾‹å­ä¸­çš„(300,20)å°ºå¯¸ï¼Œä¼šæ·»åŠ ä¸‹é¢çš„çº¦æŸæ¡ä»¶ï¼š<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="string">NSContentSizeLayoutConstraint:</span><span class="number">0x7fef48d52580</span> <span class="string">H:</span>[<span class="string">AwesomeView:</span><span class="number">0x7fef48ead7f0</span>(<span class="number">300</span>)] <span class="string">Hug:</span><span class="number">250</span> <span class="string">CompressionResistance:</span><span class="number">750</span>&gt;,</div><div class="line">&lt;<span class="string">NSContentSizeLayoutConstraint:</span><span class="number">0x7fef48d4d110</span> <span class="string">V:</span>[<span class="string">AwesomeView:</span><span class="number">0x7fef48ead7f0</span>(<span class="number">20</span>)] <span class="string">Hug:</span><span class="number">250</span> <span class="string">CompressionResistance:</span><span class="number">750</span>&gt;</div></pre></td></tr></table></figure></p>
<p>æ·»åŠ çš„çº¦æŸæ¡ä»¶æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä»¬æ˜¯<em>NSContentSizeLayoutConstraint</em>ç±»å‹çš„ï¼Œè¿™ä¸ªç±»æ˜¯ä¸ªç§æœ‰ç±»ã€‚è¿™äº›çº¦æŸæ¡ä»¶çš„ä¼˜å…ˆçº§èŒƒå›´æ˜¯0-1000ï¼Œâ€œåŒ…ä½é™åˆ¶â€ï¼ˆè¯‘è€…æ³¨ï¼šhug consistanceï¼Œä½¿å…¶åœ¨â€œå†…å®¹å¤§å°â€çš„åŸºç¡€ä¸Šä¸èƒ½ç»§ç»­å˜å¤§ï¼‰çš„ä¼˜å…ˆçº§æ˜¯250ï¼Œâ€œæ’‘ä½é™åˆ¶â€ï¼ˆcompression resistanceï¼Œæ’‘ä½ä½¿å…¶åœ¨åœ¨å…¶â€œå†…å®¹å¤§å°â€çš„åŸºç¡€ä¸Šä¸èƒ½ç»§ç»­å˜å°ï¼‰çš„ä¼˜å…ˆçº§æ˜¯750ï¼Œä½¿ç”¨çš„å¸¸é‡ç­‰äºé€šè¿‡<em>intrinsicContentSize</em>è¿”å›çš„å€¼ã€‚</p>
<p>è¯·æ³¨æ„ï¼ŒUIViewåŸºç±»å®ç°<strong>updateConstraints</strong>åªæœ‰åœ¨å®ƒç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™æ‰ä¼šæ·»åŠ <em>intrinsicContentSize</em>çº¦æŸã€‚</p>
<h4 id="UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™è‡ªèº«çš„å°ºå¯¸æ·»åŠ çº¦æŸ"><a href="#UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™è‡ªèº«çš„å°ºå¯¸æ·»åŠ çº¦æŸ" class="headerlink" title="UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™è‡ªèº«çš„å°ºå¯¸æ·»åŠ çº¦æŸ"></a>UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™è‡ªèº«çš„å°ºå¯¸æ·»åŠ çº¦æŸ</h4><p>æ¯ä¸ªviewéƒ½ä¼šè´Ÿè´£ç»™å®ƒçš„superviewè®¾ç½®çº¦æŸï¼Œä½†æ˜¯view<strong>ç»ä¸åº”è¯¥</strong>è®¾ç½®å®ƒè‡ªå·±çš„çº¦æŸæ¡ä»¶ï¼Œä¸ç®¡æ˜¯å¯¹äºè‡ªèº«çš„çº¦æŸï¼ˆæ¯”å¦‚è¯´<em> NSLayoutAttributeWidth</em>å’Œ<em> NSLayoutAttributeHeight</em>ï¼‰ï¼Œè¿˜æ˜¯ç›¸å¯¹äºsuperviewçš„çº¦æŸã€‚</p>
<p>å¦‚æœä¸€ä¸ªviewæƒ³æŒ‡å®šè‡ªå·±çš„é«˜åº¦æˆ–è€…å®½åº¦ï¼Œå®ƒåº”è¯¥é€šè¿‡å®ç°<em> intrinsicContentSize</em>æ¥è¾¾åˆ°ç›®çš„ã€‚</p>
<p>è¿™æ˜¯ä¸ªç³Ÿç³•çš„ä¾‹å­ï¼š<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (instancetype)init</div><div class="line">&#123;</div><div class="line">     self = [<span class="keyword">super</span> init];</div><div class="line">     <span class="keyword">if</span> (self) &#123;</div><div class="line">         [self <span class="string">addConstraint:</span>[NSLayoutConstraint <span class="string">constraintWithItem:</span>self <span class="string">attribute:</span>NSLayoutAttributeWidth <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>nil <span class="string">attribute:</span><span class="number">0</span> <span class="string">multiplier:</span><span class="number">0</span> <span class="string">constant:</span><span class="number">100</span>]];</div><div class="line">         [self <span class="string">addConstraint:</span>[NSLayoutConstraint <span class="string">constraintWithItem:</span>self <span class="string">attribute:</span>NSLayoutAttributeHeight <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>nil <span class="string">attribute:</span><span class="number">0</span> <span class="string">multiplier:</span><span class="number">0</span> <span class="string">constant:</span><span class="number">100</span>]];</div><div class="line">     &#125;</div><div class="line">         <span class="keyword">return</span> self;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªviewåœ¨é€šè¿‡ç»™è‡ªèº«æ·»åŠ çº¦æŸæ¥è®¾ç½®è‡ªå·±çš„å®½åº¦å’Œé«˜åº¦ï¼Œé‚£ä¹ˆå¦‚æœç°åœ¨å®ƒçš„superviewä¹Ÿåœ¨è¯•å›¾æŒ‡å®šè¿™äº›æ•°å€¼ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Some place in the superview</span></div><div class="line">[awesome <span class="string">addConstraint:</span>[NSLayoutConstraint <span class="string">constraintWithItem:</span>awesome <span class="string">attribute:</span>NSLayoutAttributeWidth <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>nil <span class="string">attribute:</span><span class="number">0</span> <span class="string">multiplier:</span><span class="number">0</span> <span class="string">constant:</span><span class="number">200</span>]];</div><div class="line">[awesome <span class="string">addConstraint:</span>[NSLayoutConstraint <span class="string">constraintWithItem:</span>awesome <span class="string">attribute:</span>NSLayoutAttributeHeight <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>nil <span class="string">attribute:</span><span class="number">0</span> <span class="string">multiplier:</span><span class="number">0</span> <span class="string">constant:</span><span class="number">200</span>]];</div></pre></td></tr></table></figure></p>
<p>å˜­ï¼<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Unable to simultaneously satisfy constraints.</div><div class="line">â€¦</div><div class="line">property translatesAutoresizingMaskIntoConstraints)</div><div class="line">(</div><div class="line"> â€œ&lt;<span class="string">NSLayoutConstraint:</span><span class="number">0x7ff3b16c2ae0</span> <span class="string">H:</span>[<span class="string">AwesomeView:</span><span class="number">0x7ff3b16bfa00</span>(<span class="number">100</span>)]&gt;â€,</div><div class="line"> â€œ&lt;<span class="string">NSLayoutConstraint:</span><span class="number">0x7ff3b16c2330</span> <span class="string">H:</span>[<span class="string">AwesomeView:</span><span class="number">0x7ff3b16bfa00</span>(<span class="number">200</span>)]&gt;â€</div><div class="line">)</div><div class="line">Will attempt to recover by breaking constraint</div><div class="line">&lt;<span class="string">NSLayoutConstraint:</span><span class="number">0x7ff3b16c2330</span> <span class="string">H:</span>[<span class="string">AwesomeView:</span><span class="number">0x7ff3b16bfa00</span>(<span class="number">200</span>)]&gt;</div><div class="line">â€¦</div></pre></td></tr></table></figure></p>
<p><code>AwesomeView</code>æ·»åŠ çš„å®½åº¦/é«˜åº¦æ˜¯100/100ï¼Œè€Œå®ƒçš„superviewä¹Ÿæ·»åŠ äº†å®½åº¦/é«˜åº¦ï¼Œä½†æ˜¯æ˜¯200/200ï¼Œè¿™æ ·autoLayoutå°±ä¸çŸ¥é“è¯¥é€‰æ‹©å“ªä¸ªçº¦æŸæ¡ä»¶äº†ï¼Œå› ä¸ºå®ƒä»¬çš„ä¼˜å…ˆçº§éƒ½ä¸€æ ·ã€‚</p>
<p>ä¸€ç§è§£å†³åŠæ³•æ˜¯è¿™æ ·çš„ï¼Œå°†<code>AwesomeView</code>è‡ªèº«çš„ä¼˜å…ˆçº§é™ä½ä¸€ç‚¹ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[self <span class="string">addConstraint:</span>(&#123;</div><div class="line"> NSLayoutConstraint *constraint;</div><div class="line"> constraint = [NSLayoutConstraint <span class="string">constraintWithItem:</span>self <span class="string">attribute:</span>NSLayoutAttributeWidth <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>nil <span class="string">attribute:</span><span class="number">0</span> <span class="string">multiplier:</span><span class="number">0</span> <span class="string">constant:</span><span class="number">100</span>];</div><div class="line"> constraint.priority = <span class="number">800</span>;</div><div class="line"> constraint;</div><div class="line"> &#125;)];</div></pre></td></tr></table></figure>
<p>è¿™æ ·autoLayoutå°±å¯ä»¥åšå‡ºé€‰æ‹©äº†ï¼Œå› ä¸ºå®ƒè‡ªèº«æ·»åŠ çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œå®ƒå°±å¯ä»¥é€‰æ‹©superviewæ·»åŠ çš„çº¦æŸäº†ã€‚</p>
<p>ç„¶è€Œï¼Œå°½ç®¡è¿™æ ·å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ­£ç¡®çš„æ–¹å¼æ˜¯é€šè¿‡<em> intrinsicContentSize</em>æ¥æŒ‡å®šå®ƒçš„é«˜åº¦ã€‚</p>
<h4 id="UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™å®ƒçš„superviewæ·»åŠ çº¦æŸ"><a href="#UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™å®ƒçš„superviewæ·»åŠ çº¦æŸ" class="headerlink" title="UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™å®ƒçš„superviewæ·»åŠ çº¦æŸ"></a>UIViewçš„å­ç±»ç»ä¸åº”è¯¥ç»™å®ƒçš„superviewæ·»åŠ çº¦æŸ</h4><p>å’Œä¸Šé¢çš„åŸå› ä¸€æ ·ï¼Œå­è§†å›¾ç»ä¸åº”è¯¥ç»™ä»–çš„çˆ¶è§†å›¾æ·»åŠ çº¦æŸã€‚å­è§†å›¾çš„ä½ç½®æ˜¯ç”±çˆ¶è§†å›¾å†³å®šçš„ã€‚</p>
<p>åƒè¿™ä¹ˆåšå¾ˆç³Ÿç³•ï¼š<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)didMoveToSuperview &#123;</div><div class="line">     [<span class="keyword">super</span> didMoveToSuperview];</div><div class="line">     [self.superview <span class="string">addConstraint:</span>[NSLayoutConstraint <span class="string">constraintWithItem:</span>self <span class="string">attribute:</span>NSLayoutAttributeCenterX <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>self.superview <span class="string">attribute:</span>NSLayoutAttributeCenterX <span class="string">multiplier:</span><span class="number">1</span> <span class="string">constant:</span><span class="number">0</span>]];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><em>å¤ªç³Ÿç³•äº†</em>ï¼Œå®ƒä¸èƒ½ç¦»å¼€ç›¸å¯¹äºå®ƒçš„çˆ¶è§†å›¾çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œå½“çˆ¶è§†å›¾æƒ³æŠŠAwesomeæ”¾åˆ°å¦ä¸€ä¸ªä½ç½®ä¸Šä¼šæ€ä¹ˆæ ·ï¼Ÿæ˜¯çš„ï¼Œå°±ä¼šæŠ›å‡ºæ¥å¦ä¸€ä¸ª<em>Unable to simultaneously satisfy constraints</em>çš„é—®é¢˜ã€‚</p>
<h4 id="updateConstraintsæ˜¯ç”¨æ¥æ›´æ–°çº¦æŸæ¡ä»¶çš„"><a href="#updateConstraintsæ˜¯ç”¨æ¥æ›´æ–°çº¦æŸæ¡ä»¶çš„" class="headerlink" title="updateConstraintsæ˜¯ç”¨æ¥æ›´æ–°çº¦æŸæ¡ä»¶çš„"></a>updateConstraintsæ˜¯ç”¨æ¥æ›´æ–°çº¦æŸæ¡ä»¶çš„</h4><p>é¡¾åæ€ä¹‰ï¼Œ<code>updateConstraints</code>åªæ˜¯è¢«ç”¨æ¥æ›´æ–°éœ€è¦çš„çº¦æŸçš„ã€‚ä¸€ä¸ªæ­£ç¡®çš„å®ç°<code>updateConstraints</code>çš„æ–¹å¼åº”è¯¥é•¿è¿™ä¸ªæ ·å­ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)init</div><div class="line">&#123;</div><div class="line"> â€¦</div><div class="line"> init stuff</div><div class="line"> â€¦</div><div class="line"> _labelCenterYConstraints = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:label attribute:<span class="built_in">NSLayoutAttributeCenterY</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span> attribute:<span class="built_in">NSLayoutAttributeCenterY</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>];</div><div class="line"> [<span class="keyword">self</span> addConstraint:_labelCenterYConstraints];</div><div class="line"> label.text = @â€I Am truly awesome!â€;</div><div class="line"> â€¦</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)updateConstraints &#123;</div><div class="line">  <span class="keyword">self</span>.labelCenterYConstraints.constant = <span class="keyword">self</span>.labelVerticalDisplacement;</div><div class="line">  [<span class="keyword">super</span> updateConstraints];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨éœ€è¦çš„åœ°æ–¹ï¼š<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">awesome.labelVerticalDisplacement = <span class="number">40</span><span class="comment">;</span></div><div class="line">[awesome setNeedsUpdateConstraints]<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>è°ƒç”¨<code>setNeedsUpdateConstraints</code>ä¼šä½¿autoLayouté‡æ–°è®¡ç®—å¸ƒå±€ï¼Œå› æ­¤ä¼šè°ƒç”¨<em> updateConstraints</em>ï¼Œä»è€Œè¯»å–æ–°çš„labelçŠ¶æ€å¹¶æ›´æ–°çº¦æŸã€‚</p>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½ æœ¬å¯ä»¥åªæ›´æ–°<em> _labelCenterYConstraints</em>è¿™ä¸ªçº¦æŸï¼Œå¦‚æœä½ çš„è§†å›¾æš´éœ²å‡ºçº¦æŸï¼Œæˆ–è€…å¦‚æœä½ å¯ä»¥ç®€å•è·å¾—ä¸€ä¸ªçº¦æŸï¼Œé‚£å°±ç›´æ¥è®¾ç½®çº¦æŸçš„å¸¸é‡å¥½äº†ï¼Œä¸å¿…ä½¿ç”¨<em>updateConstraints</em>ã€‚æ‰€ä»¥ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥è¿™ä¹ˆå®ç°ï¼š<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awesome.labelCenterYConstraints.constant = <span class="number">40</span><span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ª<strong>éå¸¸ç³Ÿç³•</strong>çš„<em> updateConstraints</em>çš„å®ç°ä¼šé•¿è¿™ä¸ªæ ·å­ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)updateConstraints &#123;</div><div class="line">  [<span class="keyword">self</span> removeConstraints:<span class="keyword">self</span>.constraints];</div><div class="line">  <span class="comment">/*</span></div><div class="line">  create the constraint here</div><div class="line">  */</div><div class="line">  [<span class="keyword">super</span> updateConstraints];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¹ˆåšæ˜¯éå¸¸é”™è¯¯çš„ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>ç³»ç»Ÿè°ƒç”¨<em> updateConstraints</em>å¾ˆå¤šæ¬¡ï¼Œå› æ­¤ç§»é™¤æˆ–è€…é‡æ–°åˆ›å»ºå¯èƒ½ä¼šæ ¡éªŒçº¦æŸçš„åˆç†æ€§ã€‚</li>
<li><code>[self removeConstraints:self.constraints]</code>; ä¼šç§»é™¤åŒ…æ‹¬xibæˆ–storyboardåˆ›å»ºçš„æ‰€æœ‰çº¦æŸæ¡ä»¶ï¼Œä½ è¯¥æ€ä¹ˆé‡æ–°åˆ›å»ºè¿™äº›çº¦æŸï¼Ÿï¼ˆèµ¶ç´§è¯´ä½ ä¸èƒ½ï¼ï¼‰</li>
<li>ä¸Šé¢çš„<em>updateConstraints</em>å®ç°ä¼šè¦†ç›–æ‰<em>intrinsicContentSize</em>çš„æ•ˆæœï¼Œå› ä¸ºä½ åœ¨è°ƒç”¨<code>[super updateConstraints];</code>åç§»é™¤äº†ç³»ç»Ÿæ·»åŠ çš„çº¦æŸæ¡ä»¶ã€‚</li>
<li><code>updateConstraints</code>åº”è¯¥è¢«ç”¨æ¥åˆ›å»ºçº¦æŸæ¡ä»¶ä¸€æ¬¡ï¼Œç„¶åä»…ä»…ç§»é™¤æ‰å¤±æ•ˆçš„çº¦æŸã€‚å®ƒç»ä¸è¯¥æ˜¯ä¸€ä¸ªç§»é™¤æ‰€æœ‰çº¦æŸå†æŠŠæ¯ä¸ªä¼ è¿‡æ¥çš„å¸ƒå±€æ·»åŠ ä¸Šçš„åœ°æ–¹ã€‚ï¼ˆæ„Ÿè°¢Alexisæä¾›ä»¥ä¸‹è¡¥å……ã€‚ï¼‰</li>
</ul>
<p>æ­£ç¡®çš„å®ç°æ–¹å¼æ˜¯è¿™æ ·ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)updateConstraints &#123;</div><div class="line">  <span class="keyword">if</span> (!didSetConstraints) &#123;</div><div class="line"> didSetConstraints = <span class="literal">YES</span>;</div><div class="line">  <span class="comment">//create the constraint here</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">//Update the constraints if needed</span></div><div class="line">  [<span class="keyword">super</span> updateConstraints];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºçº¦æŸçš„åŠ¨ä½œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç„¶ååœ¨æ¥ä¸‹æ¥çš„<em>updateConstraints</em>è°ƒç”¨ä¸­ï¼Œåªä¼šå¯¹è¿™äº›å·²åˆ›å»ºçš„çº¦æŸçš„å¸¸é‡è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>æˆ‘ä¸€ç›´åœ¨è¿½å¯»çœŸç†ï¼æ‰€ä»¥å¦‚æœä½ æœ‰å¾ˆå¤šæ›´å¥½çš„å®è·µç»éªŒï¼Œè¯·åœ¨twitterä¸Šå’Œæˆ‘åˆ†äº«ã€‚</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2015/12/11/be-an-independent-explorer-not-a-lazy-coder/">Be an independent explorer, not a lazy coder</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2015-12-11
        </span></div>
    </header>

    <div class="post-content"><p>Hereâ€™s an SOF <a href="http://stackoverflow.com/a/18837736/1594792" title="http://stackoverflow.com/a/18837736/1594792" target="_blank" rel="external">answer</a> that makes me think.</p>
<p>Obviously, the asker required for the method of <em>simple code</em> of <a href="https://github.com/enormego/EGOCache" title="https://github.com/enormego/EGOCache" target="_blank" rel="external">EGOCache</a>  Library, since its responser didnâ€™t provide any example or demo for it.</p>
<p>Two answers provided are very interesting. One gives line-by-line code â€”- who can refuse attractive and brief code? While the other one just tells you how to dive your head first and find out on your own.</p>
<p>It says as below.</p>
<blockquote>
<p>In the Objective-C world in a case like this when there isnâ€™t as much documentation as I think there <em>should</em> be, I go straight to the header file. Then in your case I would look for a method named something like <code>setData</code> (I assumed this name even before I had read the header to answer this) which is here. Then you would use <code>dataForKey:</code> from here and finally <code>clearCache</code> from here so in short, yep your assumptions looked correct.</p>
<p>Give a man a fish, and you feed him for a day.</p>
</blockquote>
<p>It seems that we are gradually doted by the <em>Step-By-Step</em> tutorials and lose our independence to have a try. Of course, the tutorials are so friendly and helpful to fresh fish, meanwhile, they also make developers lazier.</p>
<p>In my aspect, developers are meant that you dare to explore spaces even unfamiliar to them, get down to issues, and grow up steadily even compared with yourself several days before. </p>
<p>Or else, youâ€™re just a lazy coder.</p>

        </div></article>
      <nav class="pagination"><a class="prev" href="/page/7/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    <a class="next" href="/page/9/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:calios_1124@163.com" class="iconfont icon-email" title="email"></a>
        <a href="http://github.com/caliosd" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Calios</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
