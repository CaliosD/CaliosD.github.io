<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0"/>

<link rel="stylesheet" href="/css/main.css?v=7.2.0"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"scrollpercent":false,"onmobile":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="矢量图 vs 位图（栅格图）   矢量图（vector），也叫向量图，是通过多个对象组合生成的，对于其中每一个对象的记录方式都是以数学函数来实现的，缩放不失真。常用的矢量绘制软件有Adobe Illustrator、Freehand、Flash等。位图（bitmap），也叫栅格图、像素图，即最小单位由像素构成的图，可操作对象是像素，可以改变图像的饱和度、明度和色相，缩放会失真。常用的位图绘制软件">
<meta name="keywords" content="iOS">
<meta property="og:type" content="article">
<meta property="og:title" content="CoreAnimation的几个知识点">
<meta property="og:url" content="http://www.caliosd.gq/2016/02/29/points-in-CoreAnimation/index.html">
<meta property="og:site_name" content="Calios&#39; Eden">
<meta property="og:description" content="矢量图 vs 位图（栅格图）   矢量图（vector），也叫向量图，是通过多个对象组合生成的，对于其中每一个对象的记录方式都是以数学函数来实现的，缩放不失真。常用的矢量绘制软件有Adobe Illustrator、Freehand、Flash等。位图（bitmap），也叫栅格图、像素图，即最小单位由像素构成的图，可操作对象是像素，可以改变图像的饱和度、明度和色相，缩放会失真。常用的位图绘制软件">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/a/ac/VectorGraphicsExample.jpg">
<meta property="og:image" content="https://www.w3.org/TR/SVG/images/painting/fillrule-nonzero.png">
<meta property="og:image" content="http://www.w3.org/TR/SVG/images/painting/fillrule-evenodd.png">
<meta property="og:updated_time" content="2018-09-15T08:15:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CoreAnimation的几个知识点">
<meta name="twitter:description" content="矢量图 vs 位图（栅格图）   矢量图（vector），也叫向量图，是通过多个对象组合生成的，对于其中每一个对象的记录方式都是以数学函数来实现的，缩放不失真。常用的矢量绘制软件有Adobe Illustrator、Freehand、Flash等。位图（bitmap），也叫栅格图、像素图，即最小单位由像素构成的图，可操作对象是像素，可以改变图像的饱和度、明度和色相，缩放会失真。常用的位图绘制软件">
<meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/a/ac/VectorGraphicsExample.jpg">





  
  
  <link rel="canonical" href="http://www.caliosd.gq/2016/02/29/points-in-CoreAnimation/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>CoreAnimation的几个知识点 | Calios' Eden</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Calios' Eden</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Stedfast as thou art.</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    

    

    <a href="/" rel="section">Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    

    

    <a href="/archives/" rel="section">Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    

    

    <a href="/about/" rel="section">About</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.caliosd.gq/2016/02/29/points-in-CoreAnimation/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Calios"/>
      <meta itemprop="description" content="Stedfast as thou art."/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Calios' Eden"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">CoreAnimation的几个知识点

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 02/29/16 15:40:33" itemprop="dateCreated datePublished" datetime="2016-02-29T15:40:33+08:00">02/29/16</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 09/15/18 16:15:01" itemprop="dateModified" datetime="2018-09-15T16:15:01+08:00">09/15/18</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <ul>
<li><strong>矢量图 vs 位图（栅格图）</strong></li>
</ul>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/ac/VectorGraphicsExample.jpg" alt="（a）原始矢量图；（b）矢量图放大8倍；（c）位图放大8倍。位图的放大质量较差，但是矢量图可以不降低质量地无限放大。" title="矢量图和位图显示效果对比"></p>
<p><strong>矢量图（vector）</strong>，也叫向量图，是通过多个对象组合生成的，对于其中每一个对象的记录方式都是以数学函数来实现的，缩放不失真。常用的矢量绘制软件有Adobe Illustrator、Freehand、Flash等。<br><strong>位图（bitmap）</strong>，也叫栅格图、像素图，即最小单位由像素构成的图，可操作对象是像素，可以改变图像的饱和度、明度和色相，缩放会失真。常用的位图绘制软件有Adobe Photoshop等。</p>
<ul>
<li>对于<code>position</code>和<code>anchorPoint</code>关系的理解<blockquote>
<p>Point-based coordinates are used when specifying values that map directly to screen coordinates or must be specified relative to another layer, such as for the layer’s position property. Unit coordinates are used when the value should not be tied to screen coordinates because it is relative to some other value. For example, the layer’s anchorPoint property specifies a point relative to the bounds of the layer itself, which can change. (<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html#//apple_ref/doc/uid/TP40004514-CH2-SW15" target="_blank" rel="external">Core Animation Programming Guide</a>)</p>
</blockquote>
</li>
</ul>
<p>简而言之，anchorPoint是一个点相对于layer本身的bounds而言的单元坐标，它可以改变；而position是layer相对superLayer坐标空间的位置。</p>
<p>以桌子与白纸为例，如果固定图钉在桌上的位置，也就是positon不变，这个时候图钉处在白纸的不同地方就是不同的anchorPoint，相应地也就是不同的frame。<br>另一方面，如果固定图钉在白纸上的位置（没订在桌子上），不管怎么平移白纸，anchorPoint肯定是不变的，但frame肯定是随之变化的</p>
<ul>
<li><code>useEvenOddFillRule</code></li>
</ul>
<p>在看<a href="https://github.com/kishikawakatsumi/UCZProgressView" target="_blank" rel="external">UCZProgressView</a>的代码时发现了这么一个<code>UIBezierPath</code>的属性，而看起来<code>CAShapeLayer</code>也有类似的属性，叫<code>fillRule</code>，可以设置为<code>kCAFillRuleEvenOdd</code>或<code>kCAFillRuleNonZero</code>。那这个属性到底是做什么的呢？<br>解释比较清楚的是一篇关于SVG规范的文章，好在最基本的理论都是相通的。</p>
<blockquote>
<p> ‘fill-rule’ 属性用于指定使用哪一种算法去判断画布上的某区域是否属于该图形“内部” （内部区域将被填充）。对一个简单的无交叉的路径，哪块区域是“内部” 是很直观清除的。但是，对一个复杂的路径，比如自相交或者一个子路径包围另一个子路径，“内部”的理解就不那么明确了。<br><strong>nonzero</strong><br>字面意思是“非零”。按该规则，要判断一个点是否在图形内，从该点作任意方向的一条射线，然后检测射线与图形路径的交点情况。从0开始计数，路径从左向右穿过射线则计数加1，从右向左穿过射线则计数减1。得出计数结果后，如果结果是0，则认为点在图形外部，否则认为在内部。下图演示了nonzero规则:<br><img src="https://www.w3.org/TR/SVG/images/painting/fillrule-nonzero.png" alt=""><br><strong>evenodd</strong><br>字面意思是“奇偶”。按该规则，要判断一个点是否在图形内，从该点作任意方向的一条射线，然后检测射线与图形路径的交点的数量。如果结果是奇数则认为点在内部，是偶数则认为点在外部。下图演示了evenodd 规则:<br><img src="http://www.w3.org/TR/SVG/images/painting/fillrule-evenodd.png" alt=""></p>
</blockquote>
<p>又想到了之前在一个项目中实现的中间有洞的矩形view，翻来瞅一眼。<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CAShapeLayer</span> *maskWithHole = [<span class="built_in">CAShapeLayer</span> layer];</div><div class="line"></div><div class="line"><span class="comment">// Both frames are defined in the same coordinate system</span></div><div class="line"><span class="built_in">CGRect</span> biggerRect = <span class="built_in">CGRectMake</span>(<span class="number">30</span>, <span class="number">50</span>, <span class="number">120</span>, <span class="number">200</span>);</div><div class="line"><span class="built_in">CGRect</span> smallerRect = <span class="built_in">CGRectMake</span>(<span class="number">80</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="number">80</span>);</div><div class="line"></div><div class="line"><span class="built_in">UIBezierPath</span> *maskPath = [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">[maskPath moveToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMinX</span>(biggerRect), <span class="built_in">CGRectGetMinY</span>(biggerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMinX</span>(biggerRect), <span class="built_in">CGRectGetMaxY</span>(biggerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMaxX</span>(biggerRect), <span class="built_in">CGRectGetMaxY</span>(biggerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMaxX</span>(biggerRect), <span class="built_in">CGRectGetMinY</span>(biggerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMinX</span>(biggerRect), <span class="built_in">CGRectGetMinY</span>(biggerRect))];</div><div class="line"></div><div class="line">[maskPath moveToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMinX</span>(smallerRect), <span class="built_in">CGRectGetMinY</span>(smallerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMinX</span>(smallerRect), <span class="built_in">CGRectGetMaxY</span>(smallerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMaxX</span>(smallerRect), <span class="built_in">CGRectGetMaxY</span>(smallerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMaxX</span>(smallerRect), <span class="built_in">CGRectGetMinY</span>(smallerRect))];</div><div class="line">[maskPath addLineToPoint:<span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMinX</span>(smallerRect), <span class="built_in">CGRectGetMinY</span>(smallerRect))];</div><div class="line"></div><div class="line">[maskWithHole setPath:[maskPath <span class="built_in">CGPath</span>]];</div><div class="line">**[maskWithHole setFillRule:kCAFillRuleEvenOdd];**</div><div class="line">[maskWithHole setFillColor:[[<span class="built_in">UIColor</span> orangeColor] <span class="built_in">CGColor</span>]];</div></pre></td></tr></table></figure></p>
<p>所以，为了“有洞”，最重要的是这一行<code>[maskWithHole setFillRule:kCAFillRuleEvenOdd];</code>。如果设置成<code>kCAFillRuleNonZero</code>（好吧，这个值是默认值），就会得到一个货真价实的实心矩形。当时没有意识到这句话的作用，现在终于明了了。</p>
<hr>
<p><strong>Ref:</strong></p>
<ul>
<li>Core Animation Programming Guide:<br><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html#//apple_ref/doc/uid/TP40004514-CH2-SW15" target="_blank" rel="external">https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html#//apple_ref/doc/uid/TP40004514-CH2-SW15</a></li>
<li><a href="http://stackoverflow.com/questions/10856353/crop-a-cashapelayer-retrieving-the-external-path" target="_blank" rel="external">http://stackoverflow.com/questions/10856353/crop-a-cashapelayer-retrieving-the-external-path</a></li>
<li><a href="http://blog.csdn.net/cuixiping/article/details/7848369" target="_blank" rel="external">http://blog.csdn.net/cuixiping/article/details/7848369</a></li>
<li><a href="http://stackoverflow.com/questions/14840563/how-does-usesevenoddfillrule-work" target="_blank" rel="external">http://stackoverflow.com/questions/14840563/how-does-usesevenoddfillrule-work</a></li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/02/25/UIImageWriteToSavedPhotosAlbum/" rel="next" title="UIImageWriteToSavedPhotosAlbum保存图片到系统相册">
                <i class="fa fa-chevron-left"></i> UIImageWriteToSavedPhotosAlbum保存图片到系统相册
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/02/29/toll-free bridging/" rel="prev" title="Toll-free bridging">
                Toll-free bridging <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Calios</p>
              <div class="site-description motion-element" itemprop="description">Stedfast as thou art.</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">97</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/caliosd" title="GitHub &rarr; https://github.com/caliosd" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.instagram.com/calios_1124" title="Instagram &rarr; https://www.instagram.com/calios_1124" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>Instagram</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CaliosD</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.3.7</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/affix.js?v=7.2.0"></script>

  <script src="/js/schemes/pisces.js?v=7.2.0"></script>




  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
